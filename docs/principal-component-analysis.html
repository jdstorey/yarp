<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>18 Principal Component Analysis | Yet Another R Primer!</title>
  <meta name="description" content="18 Principal Component Analysis | Yet Another R Primer!" />
  <meta name="generator" content="bookdown 0.10 and GitBook 2.6.7" />

  <meta property="og:title" content="18 Principal Component Analysis | Yet Another R Primer!" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://jdstorey.github.io/yarp/" />
  <meta property="og:image" content="https://jdstorey.github.io/yarp/images/tenor-2.gif" />
  <meta property="og:description" content="18 Principal Component Analysis | Yet Another R Primer!" />
  <meta name="github-repo" content="jdstorey/yarp" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="18 Principal Component Analysis | Yet Another R Primer!" />
  <meta name="twitter:site" content="@johnstorey" />
  <meta name="twitter:description" content="18 Principal Component Analysis | Yet Another R Primer!" />
  <meta name="twitter:image" content="https://jdstorey.github.io/yarp/images/tenor-2.gif" />

<meta name="author" content="John D. Storey" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="cluster-analysis.html">
<link rel="next" href="references.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="yarp.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><strong><a href="./index.html">Yet Another R Primer!</a></strong></li>

<li class="divider"></li>
<li><a href="index.html#section"></a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="part"><span><b>I R</b></span></li>
<li class="chapter" data-level="1" data-path="r-basics.html"><a href="r-basics.html"><i class="fa fa-check"></i><b>1</b> R Basics</a><ul>
<li class="chapter" data-level="1.1" data-path="r-basics.html"><a href="r-basics.html#what-is-r"><i class="fa fa-check"></i><b>1.1</b> What is R?</a></li>
<li class="chapter" data-level="1.2" data-path="r-basics.html"><a href="r-basics.html#pros-and-cons-of-r"><i class="fa fa-check"></i><b>1.2</b> Pros and Cons of R</a></li>
<li class="chapter" data-level="1.3" data-path="r-basics.html"><a href="r-basics.html#rstudio"><i class="fa fa-check"></i><b>1.3</b> RStudio</a></li>
<li class="chapter" data-level="1.4" data-path="r-basics.html"><a href="r-basics.html#getting-started-in-r"><i class="fa fa-check"></i><b>1.4</b> Getting Started in R</a><ul>
<li class="chapter" data-level="1.4.1" data-path="r-basics.html"><a href="r-basics.html#calculator"><i class="fa fa-check"></i><b>1.4.1</b> Calculator</a></li>
<li class="chapter" data-level="1.4.2" data-path="r-basics.html"><a href="r-basics.html#atomic-classes"><i class="fa fa-check"></i><b>1.4.2</b> Atomic Classes</a></li>
<li class="chapter" data-level="1.4.3" data-path="r-basics.html"><a href="r-basics.html#assigning-values-to-variables"><i class="fa fa-check"></i><b>1.4.3</b> Assigning Values to Variables</a></li>
<li class="chapter" data-level="1.4.4" data-path="r-basics.html"><a href="r-basics.html#more-ways-to-assign-values"><i class="fa fa-check"></i><b>1.4.4</b> More Ways to Assign Values</a></li>
<li class="chapter" data-level="1.4.5" data-path="r-basics.html"><a href="r-basics.html#evaluation"><i class="fa fa-check"></i><b>1.4.5</b> Evaluation</a></li>
<li class="chapter" data-level="1.4.6" data-path="r-basics.html"><a href="r-basics.html#functions"><i class="fa fa-check"></i><b>1.4.6</b> Functions</a></li>
<li class="chapter" data-level="1.4.7" data-path="r-basics.html"><a href="r-basics.html#accessing-help-in-r"><i class="fa fa-check"></i><b>1.4.7</b> Accessing Help in R</a></li>
<li class="chapter" data-level="1.4.8" data-path="r-basics.html"><a href="r-basics.html#variable-names"><i class="fa fa-check"></i><b>1.4.8</b> Variable Names</a></li>
<li class="chapter" data-level="1.4.9" data-path="r-basics.html"><a href="r-basics.html#vectors"><i class="fa fa-check"></i><b>1.4.9</b> Vectors</a></li>
<li class="chapter" data-level="1.4.10" data-path="r-basics.html"><a href="r-basics.html#vectors-1"><i class="fa fa-check"></i><b>1.4.10</b> Vectors</a></li>
<li class="chapter" data-level="1.4.11" data-path="r-basics.html"><a href="r-basics.html#matrices"><i class="fa fa-check"></i><b>1.4.11</b> Matrices</a></li>
<li class="chapter" data-level="1.4.12" data-path="r-basics.html"><a href="r-basics.html#factors"><i class="fa fa-check"></i><b>1.4.12</b> Factors</a></li>
<li class="chapter" data-level="1.4.13" data-path="r-basics.html"><a href="r-basics.html#lists"><i class="fa fa-check"></i><b>1.4.13</b> Lists</a></li>
<li class="chapter" data-level="1.4.14" data-path="r-basics.html"><a href="r-basics.html#lists-with-names"><i class="fa fa-check"></i><b>1.4.14</b> Lists with Names</a></li>
<li class="chapter" data-level="1.4.15" data-path="r-basics.html"><a href="r-basics.html#missing-values"><i class="fa fa-check"></i><b>1.4.15</b> Missing Values</a></li>
<li class="chapter" data-level="1.4.16" data-path="r-basics.html"><a href="r-basics.html#null"><i class="fa fa-check"></i><b>1.4.16</b> <code>NULL</code></a></li>
<li class="chapter" data-level="1.4.17" data-path="r-basics.html"><a href="r-basics.html#coercion"><i class="fa fa-check"></i><b>1.4.17</b> Coercion</a></li>
<li class="chapter" data-level="1.4.18" data-path="r-basics.html"><a href="r-basics.html#data-frames"><i class="fa fa-check"></i><b>1.4.18</b> Data Frames</a></li>
<li class="chapter" data-level="1.4.19" data-path="r-basics.html"><a href="r-basics.html#data-frames-1"><i class="fa fa-check"></i><b>1.4.19</b> Data Frames</a></li>
<li class="chapter" data-level="1.4.20" data-path="r-basics.html"><a href="r-basics.html#data-frames-2"><i class="fa fa-check"></i><b>1.4.20</b> Data Frames</a></li>
<li class="chapter" data-level="1.4.21" data-path="r-basics.html"><a href="r-basics.html#attributes"><i class="fa fa-check"></i><b>1.4.21</b> Attributes</a></li>
<li class="chapter" data-level="1.4.22" data-path="r-basics.html"><a href="r-basics.html#names"><i class="fa fa-check"></i><b>1.4.22</b> Names</a></li>
<li class="chapter" data-level="1.4.23" data-path="r-basics.html"><a href="r-basics.html#accessing-names"><i class="fa fa-check"></i><b>1.4.23</b> Accessing Names</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="reproducible-data-analysis.html"><a href="reproducible-data-analysis.html"><i class="fa fa-check"></i><b>2</b> Reproducible Data Analysis</a><ul>
<li class="chapter" data-level="2.1" data-path="reproducible-data-analysis.html"><a href="reproducible-data-analysis.html#definition-and-motivation"><i class="fa fa-check"></i><b>2.1</b> Definition and Motivation</a></li>
<li class="chapter" data-level="2.2" data-path="reproducible-data-analysis.html"><a href="reproducible-data-analysis.html#reproducible-vs.replicable"><i class="fa fa-check"></i><b>2.2</b> Reproducible vs. Replicable</a></li>
<li class="chapter" data-level="2.3" data-path="reproducible-data-analysis.html"><a href="reproducible-data-analysis.html#steps-to-a-reproducible-analysis"><i class="fa fa-check"></i><b>2.3</b> Steps to a Reproducible Analysis</a></li>
<li class="chapter" data-level="2.4" data-path="reproducible-data-analysis.html"><a href="reproducible-data-analysis.html#organizing-your-data-analysis"><i class="fa fa-check"></i><b>2.4</b> Organizing Your Data Analysis</a></li>
<li class="chapter" data-level="2.5" data-path="reproducible-data-analysis.html"><a href="reproducible-data-analysis.html#common-mistakes"><i class="fa fa-check"></i><b>2.5</b> Common Mistakes</a></li>
<li class="chapter" data-level="2.6" data-path="reproducible-data-analysis.html"><a href="reproducible-data-analysis.html#r-markdown"><i class="fa fa-check"></i><b>2.6</b> R Markdown</a><ul>
<li class="chapter" data-level="2.6.1" data-path="reproducible-data-analysis.html"><a href="reproducible-data-analysis.html#r-markdown-knitr"><i class="fa fa-check"></i><b>2.6.1</b> R + Markdown + knitr</a></li>
<li class="chapter" data-level="2.6.2" data-path="reproducible-data-analysis.html"><a href="reproducible-data-analysis.html#r-markdown-files"><i class="fa fa-check"></i><b>2.6.2</b> R Markdown Files</a></li>
<li class="chapter" data-level="2.6.3" data-path="reproducible-data-analysis.html"><a href="reproducible-data-analysis.html#markdown"><i class="fa fa-check"></i><b>2.6.3</b> Markdown</a></li>
<li class="chapter" data-level="2.6.4" data-path="reproducible-data-analysis.html"><a href="reproducible-data-analysis.html#latex"><i class="fa fa-check"></i><b>2.6.4</b> LaTeX</a></li>
<li class="chapter" data-level="2.6.5" data-path="reproducible-data-analysis.html"><a href="reproducible-data-analysis.html#knitr"><i class="fa fa-check"></i><b>2.6.5</b> knitr</a></li>
<li class="chapter" data-level="2.6.6" data-path="reproducible-data-analysis.html"><a href="reproducible-data-analysis.html#knitr-chunks"><i class="fa fa-check"></i><b>2.6.6</b> knitr Chunks</a></li>
<li class="chapter" data-level="2.6.7" data-path="reproducible-data-analysis.html"><a href="reproducible-data-analysis.html#chunk-option-echo"><i class="fa fa-check"></i><b>2.6.7</b> Chunk Option: <code>echo</code></a></li>
<li class="chapter" data-level="2.6.8" data-path="reproducible-data-analysis.html"><a href="reproducible-data-analysis.html#chunk-option-results"><i class="fa fa-check"></i><b>2.6.8</b> Chunk Option: <code>results</code></a></li>
<li class="chapter" data-level="2.6.9" data-path="reproducible-data-analysis.html"><a href="reproducible-data-analysis.html#chunk-option-include"><i class="fa fa-check"></i><b>2.6.9</b> Chunk Option: <code>include</code></a></li>
<li class="chapter" data-level="2.6.10" data-path="reproducible-data-analysis.html"><a href="reproducible-data-analysis.html#chunk-option-eval"><i class="fa fa-check"></i><b>2.6.10</b> Chunk Option: <code>eval</code></a></li>
<li class="chapter" data-level="2.6.11" data-path="reproducible-data-analysis.html"><a href="reproducible-data-analysis.html#chunk-names"><i class="fa fa-check"></i><b>2.6.11</b> Chunk Names</a></li>
<li class="chapter" data-level="2.6.12" data-path="reproducible-data-analysis.html"><a href="reproducible-data-analysis.html#knitr-option-cache"><i class="fa fa-check"></i><b>2.6.12</b> knitr Option: <code>cache</code></a></li>
<li class="chapter" data-level="2.6.13" data-path="reproducible-data-analysis.html"><a href="reproducible-data-analysis.html#knitr-options-figures"><i class="fa fa-check"></i><b>2.6.13</b> knitr Options: figures</a></li>
<li class="chapter" data-level="2.6.14" data-path="reproducible-data-analysis.html"><a href="reproducible-data-analysis.html#changing-default-chunk-settings"><i class="fa fa-check"></i><b>2.6.14</b> Changing Default Chunk Settings</a></li>
<li class="chapter" data-level="2.6.15" data-path="reproducible-data-analysis.html"><a href="reproducible-data-analysis.html#documentation-and-examples"><i class="fa fa-check"></i><b>2.6.15</b> Documentation and Examples</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="r-programming.html"><a href="r-programming.html"><i class="fa fa-check"></i><b>3</b> R Programming</a><ul>
<li class="chapter" data-level="3.1" data-path="r-programming.html"><a href="r-programming.html#control-structures"><i class="fa fa-check"></i><b>3.1</b> Control Structures</a><ul>
<li class="chapter" data-level="3.1.1" data-path="r-programming.html"><a href="r-programming.html#rationale"><i class="fa fa-check"></i><b>3.1.1</b> Rationale</a></li>
<li class="chapter" data-level="3.1.2" data-path="r-programming.html"><a href="r-programming.html#common-control-structures"><i class="fa fa-check"></i><b>3.1.2</b> Common Control Structures</a></li>
<li class="chapter" data-level="3.1.3" data-path="r-programming.html"><a href="r-programming.html#some-boolean-logic"><i class="fa fa-check"></i><b>3.1.3</b> Some Boolean Logic</a></li>
<li class="chapter" data-level="3.1.4" data-path="r-programming.html"><a href="r-programming.html#if"><i class="fa fa-check"></i><b>3.1.4</b> <code>if</code></a></li>
<li class="chapter" data-level="3.1.5" data-path="r-programming.html"><a href="r-programming.html#if-else"><i class="fa fa-check"></i><b>3.1.5</b> <code>if</code>-<code>else</code></a></li>
<li class="chapter" data-level="3.1.6" data-path="r-programming.html"><a href="r-programming.html#for-loops"><i class="fa fa-check"></i><b>3.1.6</b> <code>for</code> Loops</a></li>
<li class="chapter" data-level="3.1.7" data-path="r-programming.html"><a href="r-programming.html#nested-for-loops"><i class="fa fa-check"></i><b>3.1.7</b> Nested <code>for</code> Loops</a></li>
<li class="chapter" data-level="3.1.8" data-path="r-programming.html"><a href="r-programming.html#while"><i class="fa fa-check"></i><b>3.1.8</b> <code>while</code></a></li>
<li class="chapter" data-level="3.1.9" data-path="r-programming.html"><a href="r-programming.html#repeat"><i class="fa fa-check"></i><b>3.1.9</b> <code>repeat</code></a></li>
<li class="chapter" data-level="3.1.10" data-path="r-programming.html"><a href="r-programming.html#break-and-next"><i class="fa fa-check"></i><b>3.1.10</b> <code>break</code> and <code>next</code></a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="r-programming.html"><a href="r-programming.html#vectorized-operations"><i class="fa fa-check"></i><b>3.2</b> Vectorized Operations</a><ul>
<li class="chapter" data-level="3.2.1" data-path="r-programming.html"><a href="r-programming.html#calculations-on-vectors"><i class="fa fa-check"></i><b>3.2.1</b> Calculations on Vectors</a></li>
<li class="chapter" data-level="3.2.2" data-path="r-programming.html"><a href="r-programming.html#a-caveat"><i class="fa fa-check"></i><b>3.2.2</b> A Caveat</a></li>
<li class="chapter" data-level="3.2.3" data-path="r-programming.html"><a href="r-programming.html#vectorized-matrix-operations"><i class="fa fa-check"></i><b>3.2.3</b> Vectorized Matrix Operations</a></li>
<li class="chapter" data-level="3.2.4" data-path="r-programming.html"><a href="r-programming.html#mixing-vectors-and-matrices"><i class="fa fa-check"></i><b>3.2.4</b> Mixing Vectors and Matrices</a></li>
<li class="chapter" data-level="3.2.5" data-path="r-programming.html"><a href="r-programming.html#mixing-vectors-and-matrices-1"><i class="fa fa-check"></i><b>3.2.5</b> Mixing Vectors and Matrices</a></li>
<li class="chapter" data-level="3.2.6" data-path="r-programming.html"><a href="r-programming.html#vectorized-boolean-logic"><i class="fa fa-check"></i><b>3.2.6</b> Vectorized Boolean Logic</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="r-programming.html"><a href="r-programming.html#subsetting-r-objects"><i class="fa fa-check"></i><b>3.3</b> Subsetting R Objects</a><ul>
<li class="chapter" data-level="3.3.1" data-path="r-programming.html"><a href="r-programming.html#subsetting-vectors"><i class="fa fa-check"></i><b>3.3.1</b> Subsetting Vectors</a></li>
<li class="chapter" data-level="3.3.2" data-path="r-programming.html"><a href="r-programming.html#subsetting-vectors-1"><i class="fa fa-check"></i><b>3.3.2</b> Subsetting Vectors</a></li>
<li class="chapter" data-level="3.3.3" data-path="r-programming.html"><a href="r-programming.html#subsettng-matrices"><i class="fa fa-check"></i><b>3.3.3</b> Subsettng Matrices</a></li>
<li class="chapter" data-level="3.3.4" data-path="r-programming.html"><a href="r-programming.html#subsettng-matrices-1"><i class="fa fa-check"></i><b>3.3.4</b> Subsettng Matrices</a></li>
<li class="chapter" data-level="3.3.5" data-path="r-programming.html"><a href="r-programming.html#subsettng-matrices-2"><i class="fa fa-check"></i><b>3.3.5</b> Subsettng Matrices</a></li>
<li class="chapter" data-level="3.3.6" data-path="r-programming.html"><a href="r-programming.html#subsetting-lists"><i class="fa fa-check"></i><b>3.3.6</b> Subsetting Lists</a></li>
<li class="chapter" data-level="3.3.7" data-path="r-programming.html"><a href="r-programming.html#subsetting-data-frames"><i class="fa fa-check"></i><b>3.3.7</b> Subsetting Data Frames</a></li>
<li class="chapter" data-level="3.3.8" data-path="r-programming.html"><a href="r-programming.html#subsetting-data-frames-1"><i class="fa fa-check"></i><b>3.3.8</b> Subsetting Data Frames</a></li>
<li class="chapter" data-level="3.3.9" data-path="r-programming.html"><a href="r-programming.html#note-on-data-frames"><i class="fa fa-check"></i><b>3.3.9</b> Note on Data Frames</a></li>
<li class="chapter" data-level="3.3.10" data-path="r-programming.html"><a href="r-programming.html#missing-values-1"><i class="fa fa-check"></i><b>3.3.10</b> Missing Values</a></li>
<li class="chapter" data-level="3.3.11" data-path="r-programming.html"><a href="r-programming.html#subsetting-by-matching"><i class="fa fa-check"></i><b>3.3.11</b> Subsetting by Matching</a></li>
<li class="chapter" data-level="3.3.12" data-path="r-programming.html"><a href="r-programming.html#advanced-subsetting"><i class="fa fa-check"></i><b>3.3.12</b> Advanced Subsetting</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="r-programming.html"><a href="r-programming.html#functions-1"><i class="fa fa-check"></i><b>3.4</b> Functions</a><ul>
<li class="chapter" data-level="3.4.1" data-path="r-programming.html"><a href="r-programming.html#rationale-1"><i class="fa fa-check"></i><b>3.4.1</b> Rationale</a></li>
<li class="chapter" data-level="3.4.2" data-path="r-programming.html"><a href="r-programming.html#defining-a-new-function"><i class="fa fa-check"></i><b>3.4.2</b> Defining a New Function</a></li>
<li class="chapter" data-level="3.4.3" data-path="r-programming.html"><a href="r-programming.html#example-1"><i class="fa fa-check"></i><b>3.4.3</b> Example 1</a></li>
<li class="chapter" data-level="3.4.4" data-path="r-programming.html"><a href="r-programming.html#example-2"><i class="fa fa-check"></i><b>3.4.4</b> Example 2</a></li>
<li class="chapter" data-level="3.4.5" data-path="r-programming.html"><a href="r-programming.html#example-3"><i class="fa fa-check"></i><b>3.4.5</b> Example 3</a></li>
<li class="chapter" data-level="3.4.6" data-path="r-programming.html"><a href="r-programming.html#default-function-argument-values"><i class="fa fa-check"></i><b>3.4.6</b> Default Function Argument Values</a></li>
<li class="chapter" data-level="3.4.7" data-path="r-programming.html"><a href="r-programming.html#the-ellipsis-argument"><i class="fa fa-check"></i><b>3.4.7</b> The Ellipsis Argument</a></li>
<li class="chapter" data-level="3.4.8" data-path="r-programming.html"><a href="r-programming.html#argument-matching"><i class="fa fa-check"></i><b>3.4.8</b> Argument Matching</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="r-programming.html"><a href="r-programming.html#environment"><i class="fa fa-check"></i><b>3.5</b> Environment</a><ul>
<li class="chapter" data-level="3.5.1" data-path="r-programming.html"><a href="r-programming.html#loading-.rdata-files"><i class="fa fa-check"></i><b>3.5.1</b> Loading <code>.RData</code> Files</a></li>
<li class="chapter" data-level="3.5.2" data-path="r-programming.html"><a href="r-programming.html#listing-objects"><i class="fa fa-check"></i><b>3.5.2</b> Listing Objects</a></li>
<li class="chapter" data-level="3.5.3" data-path="r-programming.html"><a href="r-programming.html#removing-objects"><i class="fa fa-check"></i><b>3.5.3</b> Removing Objects</a></li>
<li class="chapter" data-level="3.5.4" data-path="r-programming.html"><a href="r-programming.html#advanced"><i class="fa fa-check"></i><b>3.5.4</b> Advanced</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="r-programming.html"><a href="r-programming.html#packages"><i class="fa fa-check"></i><b>3.6</b> Packages</a><ul>
<li class="chapter" data-level="3.6.1" data-path="r-programming.html"><a href="r-programming.html#rationale-2"><i class="fa fa-check"></i><b>3.6.1</b> Rationale</a></li>
<li class="chapter" data-level="3.6.2" data-path="r-programming.html"><a href="r-programming.html#contents-of-a-package"><i class="fa fa-check"></i><b>3.6.2</b> Contents of a Package</a></li>
<li class="chapter" data-level="3.6.3" data-path="r-programming.html"><a href="r-programming.html#installing-packages"><i class="fa fa-check"></i><b>3.6.3</b> Installing Packages</a></li>
<li class="chapter" data-level="3.6.4" data-path="r-programming.html"><a href="r-programming.html#loading-packages"><i class="fa fa-check"></i><b>3.6.4</b> Loading Packages</a></li>
<li class="chapter" data-level="3.6.5" data-path="r-programming.html"><a href="r-programming.html#getting-started-with-a-package"><i class="fa fa-check"></i><b>3.6.5</b> Getting Started with a Package</a></li>
<li class="chapter" data-level="3.6.6" data-path="r-programming.html"><a href="r-programming.html#specifying-a-function-within-a-package"><i class="fa fa-check"></i><b>3.6.6</b> Specifying a Function within a Package</a></li>
<li class="chapter" data-level="3.6.7" data-path="r-programming.html"><a href="r-programming.html#more-on-packages"><i class="fa fa-check"></i><b>3.6.7</b> More on Packages</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="r-programming.html"><a href="r-programming.html#organizing-your-code"><i class="fa fa-check"></i><b>3.7</b> Organizing Your Code</a><ul>
<li class="chapter" data-level="3.7.1" data-path="r-programming.html"><a href="r-programming.html#suggestions"><i class="fa fa-check"></i><b>3.7.1</b> Suggestions</a></li>
<li class="chapter" data-level="3.7.2" data-path="r-programming.html"><a href="r-programming.html#where-to-put-files"><i class="fa fa-check"></i><b>3.7.2</b> Where to Put Files</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="getting-data-in-and-out-of-r.html"><a href="getting-data-in-and-out-of-r.html"><i class="fa fa-check"></i><b>4</b> Getting Data In and Out of R</a><ul>
<li class="chapter" data-level="4.1" data-path="getting-data-in-and-out-of-r.html"><a href="getting-data-in-and-out-of-r.html#rdata-files"><i class="fa fa-check"></i><b>4.1</b> <code>.RData</code> Files</a></li>
<li class="chapter" data-level="4.2" data-path="getting-data-in-and-out-of-r.html"><a href="getting-data-in-and-out-of-r.html#readr-package"><i class="fa fa-check"></i><b>4.2</b> <code>readr</code> Package</a></li>
<li class="chapter" data-level="4.3" data-path="getting-data-in-and-out-of-r.html"><a href="getting-data-in-and-out-of-r.html#scraping-from-the-web"><i class="fa fa-check"></i><b>4.3</b> Scraping from the Web</a></li>
<li class="chapter" data-level="4.4" data-path="getting-data-in-and-out-of-r.html"><a href="getting-data-in-and-out-of-r.html#apis"><i class="fa fa-check"></i><b>4.4</b> APIs</a></li>
</ul></li>
<li class="part"><span><b>II Data Wrangling</b></span></li>
<li class="chapter" data-level="5" data-path="data-wrangling-chapter.html"><a href="data-wrangling-chapter.html"><i class="fa fa-check"></i><b>5</b> Data Wrangling</a><ul>
<li class="chapter" data-level="5.1" data-path="data-wrangling-chapter.html"><a href="data-wrangling-chapter.html#definition"><i class="fa fa-check"></i><b>5.1</b> Definition</a></li>
<li class="chapter" data-level="5.2" data-path="data-wrangling-chapter.html"><a href="data-wrangling-chapter.html#wrangling-challenges"><i class="fa fa-check"></i><b>5.2</b> Wrangling Challenges</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="tidy-data.html"><a href="tidy-data.html"><i class="fa fa-check"></i><b>6</b> Tidy Data</a><ul>
<li class="chapter" data-level="6.1" data-path="tidy-data.html"><a href="tidy-data.html#motivation"><i class="fa fa-check"></i><b>6.1</b> Motivation</a></li>
<li class="chapter" data-level="6.2" data-path="tidy-data.html"><a href="tidy-data.html#definition-1"><i class="fa fa-check"></i><b>6.2</b> Definition</a></li>
<li class="chapter" data-level="6.3" data-path="tidy-data.html"><a href="tidy-data.html#example-titanic-data"><i class="fa fa-check"></i><b>6.3</b> Example: Titanic Data</a><ul>
<li class="chapter" data-level="6.3.1" data-path="tidy-data.html"><a href="tidy-data.html#intuitive-format"><i class="fa fa-check"></i><b>6.3.1</b> Intuitive Format</a></li>
<li class="chapter" data-level="6.3.2" data-path="tidy-data.html"><a href="tidy-data.html#tidy-format"><i class="fa fa-check"></i><b>6.3.2</b> Tidy Format</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="tidy-data.html"><a href="tidy-data.html#rules-of-thumb"><i class="fa fa-check"></i><b>6.4</b> Rules of Thumb</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="tidyverse.html"><a href="tidyverse.html"><i class="fa fa-check"></i><b>7</b> Tidyverse</a><ul>
<li class="chapter" data-level="7.1" data-path="tidyverse.html"><a href="tidyverse.html#idea"><i class="fa fa-check"></i><b>7.1</b> Idea</a></li>
<li class="chapter" data-level="7.2" data-path="tidyverse.html"><a href="tidyverse.html#packages-1"><i class="fa fa-check"></i><b>7.2</b> Packages</a></li>
<li class="chapter" data-level="7.3" data-path="tidyverse.html"><a href="tidyverse.html#primary-packages"><i class="fa fa-check"></i><b>7.3</b> Primary Packages</a></li>
<li class="chapter" data-level="7.4" data-path="tidyverse.html"><a href="tidyverse.html#tidying-data"><i class="fa fa-check"></i><b>7.4</b> Tidying Data</a><ul>
<li class="chapter" data-level="7.4.1" data-path="tidyverse.html"><a href="tidyverse.html#tidyr-package"><i class="fa fa-check"></i><b>7.4.1</b> <code>tidyr</code> Package</a></li>
<li class="chapter" data-level="7.4.2" data-path="tidyverse.html"><a href="tidyverse.html#untidy-titanic-data"><i class="fa fa-check"></i><b>7.4.2</b> Untidy Titanic Data</a></li>
<li class="chapter" data-level="7.4.3" data-path="tidyverse.html"><a href="tidyverse.html#gather"><i class="fa fa-check"></i><b>7.4.3</b> <code>gather()</code></a></li>
<li class="chapter" data-level="7.4.4" data-path="tidyverse.html"><a href="tidyverse.html#spread"><i class="fa fa-check"></i><b>7.4.4</b> <code>spread()</code></a></li>
<li class="chapter" data-level="7.4.5" data-path="tidyverse.html"><a href="tidyverse.html#tidy-with-spread"><i class="fa fa-check"></i><b>7.4.5</b> Tidy with <code>spread()</code></a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="tidyverse.html"><a href="tidyverse.html#reshaping-data"><i class="fa fa-check"></i><b>7.5</b> Reshaping Data</a><ul>
<li class="chapter" data-level="7.5.1" data-path="tidyverse.html"><a href="tidyverse.html#wide-vs.long-format"><i class="fa fa-check"></i><b>7.5.1</b> Wide vs. Long Format</a></li>
<li class="chapter" data-level="7.5.2" data-path="tidyverse.html"><a href="tidyverse.html#reshape2-package"><i class="fa fa-check"></i><b>7.5.2</b> <code>reshape2</code> Package</a></li>
<li class="chapter" data-level="7.5.3" data-path="tidyverse.html"><a href="tidyverse.html#air-quality-data-set"><i class="fa fa-check"></i><b>7.5.3</b> Air Quality Data Set</a></li>
<li class="chapter" data-level="7.5.4" data-path="tidyverse.html"><a href="tidyverse.html#melt"><i class="fa fa-check"></i><b>7.5.4</b> Melt</a></li>
<li class="chapter" data-level="7.5.5" data-path="tidyverse.html"><a href="tidyverse.html#guided-melt"><i class="fa fa-check"></i><b>7.5.5</b> Guided Melt</a></li>
<li class="chapter" data-level="7.5.6" data-path="tidyverse.html"><a href="tidyverse.html#casting"><i class="fa fa-check"></i><b>7.5.6</b> Casting</a></li>
<li class="chapter" data-level="7.5.7" data-path="tidyverse.html"><a href="tidyverse.html#dcast"><i class="fa fa-check"></i><b>7.5.7</b> <code>dcast()</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="transforming-data.html"><a href="transforming-data.html"><i class="fa fa-check"></i><b>8</b> Transforming Data</a><ul>
<li class="chapter" data-level="8.1" data-path="transforming-data.html"><a href="transforming-data.html#dplyr-package"><i class="fa fa-check"></i><b>8.1</b> <code>dplyr</code> Package</a></li>
<li class="chapter" data-level="8.2" data-path="transforming-data.html"><a href="transforming-data.html#grammar-of-dplyr"><i class="fa fa-check"></i><b>8.2</b> Grammar of <code>dplyr</code></a></li>
<li class="chapter" data-level="8.3" data-path="transforming-data.html"><a href="transforming-data.html#baby-names-data-set"><i class="fa fa-check"></i><b>8.3</b> Baby Names Data Set</a></li>
<li class="chapter" data-level="8.4" data-path="transforming-data.html"><a href="transforming-data.html#operator"><i class="fa fa-check"></i><b>8.4</b> <code>%&gt;%</code> Operator</a></li>
<li class="chapter" data-level="8.5" data-path="transforming-data.html"><a href="transforming-data.html#filter"><i class="fa fa-check"></i><b>8.5</b> <code>filter()</code></a></li>
<li class="chapter" data-level="8.6" data-path="transforming-data.html"><a href="transforming-data.html#arrange"><i class="fa fa-check"></i><b>8.6</b> <code>arrange()</code></a></li>
<li class="chapter" data-level="8.7" data-path="transforming-data.html"><a href="transforming-data.html#rename"><i class="fa fa-check"></i><b>8.7</b> <code>rename()</code></a></li>
<li class="chapter" data-level="8.8" data-path="transforming-data.html"><a href="transforming-data.html#select"><i class="fa fa-check"></i><b>8.8</b> <code>select()</code></a></li>
<li class="chapter" data-level="8.9" data-path="transforming-data.html"><a href="transforming-data.html#mutate"><i class="fa fa-check"></i><b>8.9</b> <code>mutate()</code></a></li>
<li class="chapter" data-level="8.10" data-path="transforming-data.html"><a href="transforming-data.html#distinct"><i class="fa fa-check"></i><b>8.10</b> <code>distinct()</code></a></li>
<li class="chapter" data-level="8.11" data-path="transforming-data.html"><a href="transforming-data.html#summarize"><i class="fa fa-check"></i><b>8.11</b> <code>summarize()</code></a></li>
<li class="chapter" data-level="8.12" data-path="transforming-data.html"><a href="transforming-data.html#group_by"><i class="fa fa-check"></i><b>8.12</b> <code>group_by()</code></a></li>
<li class="chapter" data-level="8.13" data-path="transforming-data.html"><a href="transforming-data.html#chaining-verbs-together"><i class="fa fa-check"></i><b>8.13</b> Chaining Verbs Together</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="relational-data.html"><a href="relational-data.html"><i class="fa fa-check"></i><b>9</b> Relational Data</a><ul>
<li class="chapter" data-level="9.1" data-path="relational-data.html"><a href="relational-data.html#multiple-data-sets"><i class="fa fa-check"></i><b>9.1</b> Multiple Data Sets</a></li>
<li class="chapter" data-level="9.2" data-path="relational-data.html"><a href="relational-data.html#toy-example"><i class="fa fa-check"></i><b>9.2</b> Toy Example</a></li>
<li class="chapter" data-level="9.3" data-path="relational-data.html"><a href="relational-data.html#verbs"><i class="fa fa-check"></i><b>9.3</b> Verbs</a></li>
<li class="chapter" data-level="9.4" data-path="relational-data.html"><a href="relational-data.html#inner_join"><i class="fa fa-check"></i><b>9.4</b> <code>inner_join()</code></a></li>
<li class="chapter" data-level="9.5" data-path="relational-data.html"><a href="relational-data.html#left_join"><i class="fa fa-check"></i><b>9.5</b> <code>left_join()</code></a></li>
<li class="chapter" data-level="9.6" data-path="relational-data.html"><a href="relational-data.html#right_join"><i class="fa fa-check"></i><b>9.6</b> <code>right_join()</code></a></li>
<li class="chapter" data-level="9.7" data-path="relational-data.html"><a href="relational-data.html#full_join"><i class="fa fa-check"></i><b>9.7</b> <code>full_join()</code></a></li>
<li class="chapter" data-level="9.8" data-path="relational-data.html"><a href="relational-data.html#anti_join"><i class="fa fa-check"></i><b>9.8</b> <code>anti_join()</code></a></li>
<li class="chapter" data-level="9.9" data-path="relational-data.html"><a href="relational-data.html#semi_join"><i class="fa fa-check"></i><b>9.9</b> <code>semi_join()</code></a></li>
<li class="chapter" data-level="9.10" data-path="relational-data.html"><a href="relational-data.html#repeated-key-values"><i class="fa fa-check"></i><b>9.10</b> Repeated Key Values</a></li>
<li class="chapter" data-level="9.11" data-path="relational-data.html"><a href="relational-data.html#set-operations"><i class="fa fa-check"></i><b>9.11</b> Set Operations</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="case-study-in-data-wrangling.html"><a href="case-study-in-data-wrangling.html"><i class="fa fa-check"></i><b>10</b> Case Study in Data Wrangling</a><ul>
<li class="chapter" data-level="10.1" data-path="case-study-in-data-wrangling.html"><a href="case-study-in-data-wrangling.html#yeast-genomics"><i class="fa fa-check"></i><b>10.1</b> Yeast Genomics</a><ul>
<li class="chapter" data-level="10.1.1" data-path="case-study-in-data-wrangling.html"><a href="case-study-in-data-wrangling.html#load-data"><i class="fa fa-check"></i><b>10.1.1</b> Load Data</a></li>
<li class="chapter" data-level="10.1.2" data-path="case-study-in-data-wrangling.html"><a href="case-study-in-data-wrangling.html#gene-expression-matrices"><i class="fa fa-check"></i><b>10.1.2</b> Gene Expression Matrices</a></li>
<li class="chapter" data-level="10.1.3" data-path="case-study-in-data-wrangling.html"><a href="case-study-in-data-wrangling.html#gene-position-matrix"><i class="fa fa-check"></i><b>10.1.3</b> Gene Position Matrix</a></li>
<li class="chapter" data-level="10.1.4" data-path="case-study-in-data-wrangling.html"><a href="case-study-in-data-wrangling.html#row-names"><i class="fa fa-check"></i><b>10.1.4</b> Row Names</a></li>
<li class="chapter" data-level="10.1.5" data-path="case-study-in-data-wrangling.html"><a href="case-study-in-data-wrangling.html#unify-column-names"><i class="fa fa-check"></i><b>10.1.5</b> Unify Column Names</a></li>
<li class="chapter" data-level="10.1.6" data-path="case-study-in-data-wrangling.html"><a href="case-study-in-data-wrangling.html#gene-positions"><i class="fa fa-check"></i><b>10.1.6</b> Gene Positions</a></li>
<li class="chapter" data-level="10.1.7" data-path="case-study-in-data-wrangling.html"><a href="case-study-in-data-wrangling.html#tidy-each-expression-matrix"><i class="fa fa-check"></i><b>10.1.7</b> Tidy Each Expression Matrix</a></li>
<li class="chapter" data-level="10.1.8" data-path="case-study-in-data-wrangling.html"><a href="case-study-in-data-wrangling.html#combine-into-single-data-frame"><i class="fa fa-check"></i><b>10.1.8</b> Combine Into Single Data Frame</a></li>
<li class="chapter" data-level="10.1.9" data-path="case-study-in-data-wrangling.html"><a href="case-study-in-data-wrangling.html#join-gene-positions"><i class="fa fa-check"></i><b>10.1.9</b> Join Gene Positions</a></li>
<li class="chapter" data-level="10.1.10" data-path="case-study-in-data-wrangling.html"><a href="case-study-in-data-wrangling.html#apply-dplyr-functions"><i class="fa fa-check"></i><b>10.1.10</b> Apply <code>dplyr</code> Functions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="further-reading.html"><a href="further-reading.html"><i class="fa fa-check"></i><b>11</b> Further Reading</a><ul>
<li class="chapter" data-level="11.1" data-path="further-reading.html"><a href="further-reading.html#additional-examples"><i class="fa fa-check"></i><b>11.1</b> Additional Examples</a></li>
<li class="chapter" data-level="11.2" data-path="further-reading.html"><a href="further-reading.html#additional-dplyr-features"><i class="fa fa-check"></i><b>11.2</b> Additional <code>dplyr</code> Features</a></li>
</ul></li>
<li class="part"><span><b>III Expoloratory Data Analysis</b></span></li>
<li class="chapter" data-level="12" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html"><i class="fa fa-check"></i><b>12</b> Exploratory Data Analysis</a><ul>
<li class="chapter" data-level="12.1" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#what-is-eda"><i class="fa fa-check"></i><b>12.1</b> What is EDA?</a></li>
<li class="chapter" data-level="12.2" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#descriptive-statistics-examples"><i class="fa fa-check"></i><b>12.2</b> Descriptive Statistics Examples</a></li>
<li class="chapter" data-level="12.3" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#components-of-eda"><i class="fa fa-check"></i><b>12.3</b> Components of EDA</a></li>
<li class="chapter" data-level="12.4" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#data-sets"><i class="fa fa-check"></i><b>12.4</b> Data Sets</a><ul>
<li class="chapter" data-level="12.4.1" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#data-mtcars"><i class="fa fa-check"></i><b>12.4.1</b> Data <code>mtcars</code></a></li>
<li class="chapter" data-level="12.4.2" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#data-mpg"><i class="fa fa-check"></i><b>12.4.2</b> Data <code>mpg</code></a></li>
<li class="chapter" data-level="12.4.3" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#data-diamonds"><i class="fa fa-check"></i><b>12.4.3</b> Data <code>diamonds</code></a></li>
<li class="chapter" data-level="12.4.4" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#data-gapminder"><i class="fa fa-check"></i><b>12.4.4</b> Data <code>gapminder</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="numerical-summaries-of-data.html"><a href="numerical-summaries-of-data.html"><i class="fa fa-check"></i><b>13</b> Numerical Summaries of Data</a><ul>
<li class="chapter" data-level="13.1" data-path="numerical-summaries-of-data.html"><a href="numerical-summaries-of-data.html#useful-summaries"><i class="fa fa-check"></i><b>13.1</b> Useful Summaries</a></li>
<li class="chapter" data-level="13.2" data-path="numerical-summaries-of-data.html"><a href="numerical-summaries-of-data.html#measures-of-center"><i class="fa fa-check"></i><b>13.2</b> Measures of Center</a></li>
<li class="chapter" data-level="13.3" data-path="numerical-summaries-of-data.html"><a href="numerical-summaries-of-data.html#mean-median-and-mode-in-r"><i class="fa fa-check"></i><b>13.3</b> Mean, Median, and Mode in R</a></li>
<li class="chapter" data-level="13.4" data-path="numerical-summaries-of-data.html"><a href="numerical-summaries-of-data.html#quantiles-and-percentiles"><i class="fa fa-check"></i><b>13.4</b> Quantiles and Percentiles</a></li>
<li class="chapter" data-level="13.5" data-path="numerical-summaries-of-data.html"><a href="numerical-summaries-of-data.html#five-number-summary"><i class="fa fa-check"></i><b>13.5</b> Five Number Summary</a></li>
<li class="chapter" data-level="13.6" data-path="numerical-summaries-of-data.html"><a href="numerical-summaries-of-data.html#measures-of-spread"><i class="fa fa-check"></i><b>13.6</b> Measures of Spread</a></li>
<li class="chapter" data-level="13.7" data-path="numerical-summaries-of-data.html"><a href="numerical-summaries-of-data.html#variance-sd-and-iqr-in-r"><i class="fa fa-check"></i><b>13.7</b> Variance, SD, and IQR in R</a></li>
<li class="chapter" data-level="13.8" data-path="numerical-summaries-of-data.html"><a href="numerical-summaries-of-data.html#identifying-outliers"><i class="fa fa-check"></i><b>13.8</b> Identifying Outliers</a></li>
<li class="chapter" data-level="13.9" data-path="numerical-summaries-of-data.html"><a href="numerical-summaries-of-data.html#application-to-mtcars-data"><i class="fa fa-check"></i><b>13.9</b> Application to <code>mtcars</code> Data</a></li>
<li class="chapter" data-level="13.10" data-path="numerical-summaries-of-data.html"><a href="numerical-summaries-of-data.html#measuring-symmetry"><i class="fa fa-check"></i><b>13.10</b> Measuring Symmetry</a></li>
<li class="chapter" data-level="13.11" data-path="numerical-summaries-of-data.html"><a href="numerical-summaries-of-data.html#skewness-function"><i class="fa fa-check"></i><b>13.11</b> <code>skewness()</code> Function</a></li>
<li class="chapter" data-level="13.12" data-path="numerical-summaries-of-data.html"><a href="numerical-summaries-of-data.html#measuring-tails"><i class="fa fa-check"></i><b>13.12</b> Measuring Tails</a></li>
<li class="chapter" data-level="13.13" data-path="numerical-summaries-of-data.html"><a href="numerical-summaries-of-data.html#excess-kurtosis"><i class="fa fa-check"></i><b>13.13</b> Excess Kurtosis</a></li>
<li class="chapter" data-level="13.14" data-path="numerical-summaries-of-data.html"><a href="numerical-summaries-of-data.html#kurtosis-function"><i class="fa fa-check"></i><b>13.14</b> <code>kurtosis()</code> Function</a></li>
<li class="chapter" data-level="13.15" data-path="numerical-summaries-of-data.html"><a href="numerical-summaries-of-data.html#visualizing-skewness-and-kurtosis"><i class="fa fa-check"></i><b>13.15</b> Visualizing Skewness and Kurtosis</a></li>
<li class="chapter" data-level="13.16" data-path="numerical-summaries-of-data.html"><a href="numerical-summaries-of-data.html#covariance-and-correlation"><i class="fa fa-check"></i><b>13.16</b> Covariance and Correlation</a><ul>
<li class="chapter" data-level="13.16.1" data-path="numerical-summaries-of-data.html"><a href="numerical-summaries-of-data.html#covariance"><i class="fa fa-check"></i><b>13.16.1</b> Covariance</a></li>
<li class="chapter" data-level="13.16.2" data-path="numerical-summaries-of-data.html"><a href="numerical-summaries-of-data.html#pearson-correlation"><i class="fa fa-check"></i><b>13.16.2</b> Pearson Correlation</a></li>
<li class="chapter" data-level="13.16.3" data-path="numerical-summaries-of-data.html"><a href="numerical-summaries-of-data.html#spearman-correlation"><i class="fa fa-check"></i><b>13.16.3</b> Spearman Correlation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="data-visualization-basics.html"><a href="data-visualization-basics.html"><i class="fa fa-check"></i><b>14</b> Data Visualization Basics</a><ul>
<li class="chapter" data-level="14.1" data-path="data-visualization-basics.html"><a href="data-visualization-basics.html#plots"><i class="fa fa-check"></i><b>14.1</b> Plots</a></li>
<li class="chapter" data-level="14.2" data-path="data-visualization-basics.html"><a href="data-visualization-basics.html#r-base-graphics"><i class="fa fa-check"></i><b>14.2</b> R Base Graphics</a></li>
<li class="chapter" data-level="14.3" data-path="data-visualization-basics.html"><a href="data-visualization-basics.html#read-the-documentation"><i class="fa fa-check"></i><b>14.3</b> Read the Documentation</a></li>
<li class="chapter" data-level="14.4" data-path="data-visualization-basics.html"><a href="data-visualization-basics.html#barplot"><i class="fa fa-check"></i><b>14.4</b> Barplot</a></li>
<li class="chapter" data-level="14.5" data-path="data-visualization-basics.html"><a href="data-visualization-basics.html#boxplot"><i class="fa fa-check"></i><b>14.5</b> Boxplot</a></li>
<li class="chapter" data-level="14.6" data-path="data-visualization-basics.html"><a href="data-visualization-basics.html#constructing-boxplots"><i class="fa fa-check"></i><b>14.6</b> Constructing Boxplots</a></li>
<li class="chapter" data-level="14.7" data-path="data-visualization-basics.html"><a href="data-visualization-basics.html#boxplot-with-outliers"><i class="fa fa-check"></i><b>14.7</b> Boxplot with Outliers</a></li>
<li class="chapter" data-level="14.8" data-path="data-visualization-basics.html"><a href="data-visualization-basics.html#histogram"><i class="fa fa-check"></i><b>14.8</b> Histogram</a></li>
<li class="chapter" data-level="14.9" data-path="data-visualization-basics.html"><a href="data-visualization-basics.html#histogram-with-more-breaks"><i class="fa fa-check"></i><b>14.9</b> Histogram with More Breaks</a></li>
<li class="chapter" data-level="14.10" data-path="data-visualization-basics.html"><a href="data-visualization-basics.html#density-plot"><i class="fa fa-check"></i><b>14.10</b> Density Plot</a></li>
<li class="chapter" data-level="14.11" data-path="data-visualization-basics.html"><a href="data-visualization-basics.html#boxplot-side-by-side"><i class="fa fa-check"></i><b>14.11</b> Boxplot (Side-By-Side)</a></li>
<li class="chapter" data-level="14.12" data-path="data-visualization-basics.html"><a href="data-visualization-basics.html#stacked-barplot"><i class="fa fa-check"></i><b>14.12</b> Stacked Barplot</a></li>
<li class="chapter" data-level="14.13" data-path="data-visualization-basics.html"><a href="data-visualization-basics.html#scatterplot"><i class="fa fa-check"></i><b>14.13</b> Scatterplot</a></li>
<li class="chapter" data-level="14.14" data-path="data-visualization-basics.html"><a href="data-visualization-basics.html#quantile-quantile-plots"><i class="fa fa-check"></i><b>14.14</b> Quantile-Quantile Plots</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="a-grammar-of-graphics.html"><a href="a-grammar-of-graphics.html"><i class="fa fa-check"></i><b>15</b> A Grammar of Graphics</a><ul>
<li class="chapter" data-level="15.1" data-path="a-grammar-of-graphics.html"><a href="a-grammar-of-graphics.html#rationale-3"><i class="fa fa-check"></i><b>15.1</b> Rationale</a></li>
<li class="chapter" data-level="15.2" data-path="a-grammar-of-graphics.html"><a href="a-grammar-of-graphics.html#package-ggplot2"><i class="fa fa-check"></i><b>15.2</b> Package <code>ggplot2</code></a></li>
<li class="chapter" data-level="15.3" data-path="a-grammar-of-graphics.html"><a href="a-grammar-of-graphics.html#pieces-of-the-grammar"><i class="fa fa-check"></i><b>15.3</b> Pieces of the Grammar</a></li>
<li class="chapter" data-level="15.4" data-path="a-grammar-of-graphics.html"><a href="a-grammar-of-graphics.html#geometries"><i class="fa fa-check"></i><b>15.4</b> Geometries</a></li>
<li class="chapter" data-level="15.5" data-path="a-grammar-of-graphics.html"><a href="a-grammar-of-graphics.html#call-format"><i class="fa fa-check"></i><b>15.5</b> Call Format</a></li>
<li class="chapter" data-level="15.6" data-path="a-grammar-of-graphics.html"><a href="a-grammar-of-graphics.html#layers"><i class="fa fa-check"></i><b>15.6</b> Layers</a></li>
<li class="chapter" data-level="15.7" data-path="a-grammar-of-graphics.html"><a href="a-grammar-of-graphics.html#placement-of-the-aes-call"><i class="fa fa-check"></i><b>15.7</b> Placement of the <code>aes()</code> Call</a></li>
<li class="chapter" data-level="15.8" data-path="a-grammar-of-graphics.html"><a href="a-grammar-of-graphics.html#original-publications"><i class="fa fa-check"></i><b>15.8</b> Original Publications</a></li>
<li class="chapter" data-level="15.9" data-path="a-grammar-of-graphics.html"><a href="a-grammar-of-graphics.html#documentation"><i class="fa fa-check"></i><b>15.9</b> Documentation</a></li>
<li class="chapter" data-level="15.10" data-path="a-grammar-of-graphics.html"><a href="a-grammar-of-graphics.html#barplots"><i class="fa fa-check"></i><b>15.10</b> Barplots</a></li>
<li class="chapter" data-level="15.11" data-path="a-grammar-of-graphics.html"><a href="a-grammar-of-graphics.html#boxplots-and-violin-plots"><i class="fa fa-check"></i><b>15.11</b> Boxplots and Violin Plots</a></li>
<li class="chapter" data-level="15.12" data-path="a-grammar-of-graphics.html"><a href="a-grammar-of-graphics.html#histograms-and-density-plots"><i class="fa fa-check"></i><b>15.12</b> Histograms and Density Plots</a></li>
<li class="chapter" data-level="15.13" data-path="a-grammar-of-graphics.html"><a href="a-grammar-of-graphics.html#line-plots"><i class="fa fa-check"></i><b>15.13</b> Line Plots</a></li>
<li class="chapter" data-level="15.14" data-path="a-grammar-of-graphics.html"><a href="a-grammar-of-graphics.html#scatterplots"><i class="fa fa-check"></i><b>15.14</b> Scatterplots</a></li>
<li class="chapter" data-level="15.15" data-path="a-grammar-of-graphics.html"><a href="a-grammar-of-graphics.html#axis-scales"><i class="fa fa-check"></i><b>15.15</b> Axis Scales</a></li>
<li class="chapter" data-level="15.16" data-path="a-grammar-of-graphics.html"><a href="a-grammar-of-graphics.html#scatterplot-smoothers"><i class="fa fa-check"></i><b>15.16</b> Scatterplot Smoothers</a></li>
<li class="chapter" data-level="15.17" data-path="a-grammar-of-graphics.html"><a href="a-grammar-of-graphics.html#overplotting"><i class="fa fa-check"></i><b>15.17</b> Overplotting</a></li>
<li class="chapter" data-level="15.18" data-path="a-grammar-of-graphics.html"><a href="a-grammar-of-graphics.html#labels-and-legends"><i class="fa fa-check"></i><b>15.18</b> Labels and Legends</a></li>
<li class="chapter" data-level="15.19" data-path="a-grammar-of-graphics.html"><a href="a-grammar-of-graphics.html#facets"><i class="fa fa-check"></i><b>15.19</b> Facets</a></li>
<li class="chapter" data-level="15.20" data-path="a-grammar-of-graphics.html"><a href="a-grammar-of-graphics.html#colors"><i class="fa fa-check"></i><b>15.20</b> Colors</a><ul>
<li class="chapter" data-level="15.20.1" data-path="a-grammar-of-graphics.html"><a href="a-grammar-of-graphics.html#finding-colors"><i class="fa fa-check"></i><b>15.20.1</b> Finding Colors</a></li>
<li class="chapter" data-level="15.20.2" data-path="a-grammar-of-graphics.html"><a href="a-grammar-of-graphics.html#some-useful-layers"><i class="fa fa-check"></i><b>15.20.2</b> Some Useful Layers</a></li>
</ul></li>
<li class="chapter" data-level="15.21" data-path="a-grammar-of-graphics.html"><a href="a-grammar-of-graphics.html#saving-plots"><i class="fa fa-check"></i><b>15.21</b> Saving Plots</a><ul>
<li class="chapter" data-level="15.21.1" data-path="a-grammar-of-graphics.html"><a href="a-grammar-of-graphics.html#saving-plots-as-variables"><i class="fa fa-check"></i><b>15.21.1</b> Saving Plots as Variables</a></li>
<li class="chapter" data-level="15.21.2" data-path="a-grammar-of-graphics.html"><a href="a-grammar-of-graphics.html#saving-plots-to-files"><i class="fa fa-check"></i><b>15.21.2</b> Saving Plots to Files</a></li>
</ul></li>
<li class="chapter" data-level="15.22" data-path="a-grammar-of-graphics.html"><a href="a-grammar-of-graphics.html#dynamic-visualization"><i class="fa fa-check"></i><b>15.22</b> Dynamic Visualization</a><ul>
<li class="chapter" data-level="15.22.1" data-path="a-grammar-of-graphics.html"><a href="a-grammar-of-graphics.html#examples"><i class="fa fa-check"></i><b>15.22.1</b> Examples</a></li>
</ul></li>
<li class="chapter" data-level="15.23" data-path="a-grammar-of-graphics.html"><a href="a-grammar-of-graphics.html#themes"><i class="fa fa-check"></i><b>15.23</b> Themes</a><ul>
<li class="chapter" data-level="15.23.1" data-path="a-grammar-of-graphics.html"><a href="a-grammar-of-graphics.html#available-themes"><i class="fa fa-check"></i><b>15.23.1</b> Available Themes</a></li>
<li class="chapter" data-level="15.23.2" data-path="a-grammar-of-graphics.html"><a href="a-grammar-of-graphics.html#setting-a-theme"><i class="fa fa-check"></i><b>15.23.2</b> Setting a Theme</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="16" data-path="eda-of-high-dimensional-data.html"><a href="eda-of-high-dimensional-data.html"><i class="fa fa-check"></i><b>16</b> EDA of High-Dimensional Data</a><ul>
<li class="chapter" data-level="16.1" data-path="eda-of-high-dimensional-data.html"><a href="eda-of-high-dimensional-data.html#definition-2"><i class="fa fa-check"></i><b>16.1</b> Definition</a></li>
<li class="chapter" data-level="16.2" data-path="eda-of-high-dimensional-data.html"><a href="eda-of-high-dimensional-data.html#examples-1"><i class="fa fa-check"></i><b>16.2</b> Examples</a></li>
<li class="chapter" data-level="16.3" data-path="eda-of-high-dimensional-data.html"><a href="eda-of-high-dimensional-data.html#big-data-vs-hd-data"><i class="fa fa-check"></i><b>16.3</b> Big Data vs HD Data</a></li>
<li class="chapter" data-level="16.4" data-path="eda-of-high-dimensional-data.html"><a href="eda-of-high-dimensional-data.html#definition-of-hd-data"><i class="fa fa-check"></i><b>16.4</b> Definition of HD Data</a></li>
<li class="chapter" data-level="16.5" data-path="eda-of-high-dimensional-data.html"><a href="eda-of-high-dimensional-data.html#rationale-4"><i class="fa fa-check"></i><b>16.5</b> Rationale</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="cluster-analysis.html"><a href="cluster-analysis.html"><i class="fa fa-check"></i><b>17</b> Cluster Analysis</a><ul>
<li class="chapter" data-level="17.1" data-path="cluster-analysis.html"><a href="cluster-analysis.html#definition-3"><i class="fa fa-check"></i><b>17.1</b> Definition</a></li>
<li class="chapter" data-level="17.2" data-path="cluster-analysis.html"><a href="cluster-analysis.html#types-of-clustering"><i class="fa fa-check"></i><b>17.2</b> Types of Clustering</a></li>
<li class="chapter" data-level="17.3" data-path="cluster-analysis.html"><a href="cluster-analysis.html#top-down-vs-bottom-up"><i class="fa fa-check"></i><b>17.3</b> Top-Down vs Bottom-Up</a></li>
<li class="chapter" data-level="17.4" data-path="cluster-analysis.html"><a href="cluster-analysis.html#clustering-challenges"><i class="fa fa-check"></i><b>17.4</b> Challenges</a></li>
<li class="chapter" data-level="17.5" data-path="cluster-analysis.html"><a href="cluster-analysis.html#illustrative-data-sets"><i class="fa fa-check"></i><b>17.5</b> Illustrative Data Sets</a><ul>
<li class="chapter" data-level="17.5.1" data-path="cluster-analysis.html"><a href="cluster-analysis.html#simulated-data1"><i class="fa fa-check"></i><b>17.5.1</b> Simulated <code>data1</code></a></li>
<li class="chapter" data-level="17.5.2" data-path="cluster-analysis.html"><a href="cluster-analysis.html#true-clusters-data1"><i class="fa fa-check"></i><b>17.5.2</b> “True” Clusters <code>data1</code></a></li>
<li class="chapter" data-level="17.5.3" data-path="cluster-analysis.html"><a href="cluster-analysis.html#simulated-data2"><i class="fa fa-check"></i><b>17.5.3</b> Simulated <code>data2</code></a></li>
<li class="chapter" data-level="17.5.4" data-path="cluster-analysis.html"><a href="cluster-analysis.html#true-clusters-data2"><i class="fa fa-check"></i><b>17.5.4</b> “True” Clusters <code>data2</code></a></li>
</ul></li>
<li class="chapter" data-level="17.6" data-path="cluster-analysis.html"><a href="cluster-analysis.html#distance-measures"><i class="fa fa-check"></i><b>17.6</b> Distance Measures</a><ul>
<li class="chapter" data-level="17.6.1" data-path="cluster-analysis.html"><a href="cluster-analysis.html#objects"><i class="fa fa-check"></i><b>17.6.1</b> Objects</a></li>
<li class="chapter" data-level="17.6.2" data-path="cluster-analysis.html"><a href="cluster-analysis.html#euclidean"><i class="fa fa-check"></i><b>17.6.2</b> Euclidean</a></li>
<li class="chapter" data-level="17.6.3" data-path="cluster-analysis.html"><a href="cluster-analysis.html#manhattan"><i class="fa fa-check"></i><b>17.6.3</b> Manhattan</a></li>
<li class="chapter" data-level="17.6.4" data-path="cluster-analysis.html"><a href="cluster-analysis.html#euclidean-vs-manhattan"><i class="fa fa-check"></i><b>17.6.4</b> Euclidean vs Manhattan</a></li>
<li class="chapter" data-level="17.6.5" data-path="cluster-analysis.html"><a href="cluster-analysis.html#dist"><i class="fa fa-check"></i><b>17.6.5</b> <code>dist()</code></a></li>
<li class="chapter" data-level="17.6.6" data-path="cluster-analysis.html"><a href="cluster-analysis.html#distance-matrix-data1"><i class="fa fa-check"></i><b>17.6.6</b> Distance Matrix <code>data1</code></a></li>
</ul></li>
<li class="chapter" data-level="17.7" data-path="cluster-analysis.html"><a href="cluster-analysis.html#hierarchical-clustering"><i class="fa fa-check"></i><b>17.7</b> Hierarchical Clustering</a><ul>
<li class="chapter" data-level="17.7.1" data-path="cluster-analysis.html"><a href="cluster-analysis.html#strategy"><i class="fa fa-check"></i><b>17.7.1</b> Strategy</a></li>
<li class="chapter" data-level="17.7.2" data-path="cluster-analysis.html"><a href="cluster-analysis.html#example-cancer-subtypes"><i class="fa fa-check"></i><b>17.7.2</b> Example: Cancer Subtypes</a></li>
<li class="chapter" data-level="17.7.3" data-path="cluster-analysis.html"><a href="cluster-analysis.html#algorithm"><i class="fa fa-check"></i><b>17.7.3</b> Algorithm</a></li>
<li class="chapter" data-level="17.7.4" data-path="cluster-analysis.html"><a href="cluster-analysis.html#linkage-criteria"><i class="fa fa-check"></i><b>17.7.4</b> Linkage Criteria</a></li>
<li class="chapter" data-level="17.7.5" data-path="cluster-analysis.html"><a href="cluster-analysis.html#hclust"><i class="fa fa-check"></i><b>17.7.5</b> <code>hclust()</code></a></li>
<li class="chapter" data-level="17.7.6" data-path="cluster-analysis.html"><a href="cluster-analysis.html#hierarchical-clustering-of-data1"><i class="fa fa-check"></i><b>17.7.6</b> Hierarchical Clustering of <code>data1</code></a></li>
<li class="chapter" data-level="17.7.7" data-path="cluster-analysis.html"><a href="cluster-analysis.html#standard-hclust-usage"><i class="fa fa-check"></i><b>17.7.7</b> Standard <code>hclust()</code> Usage</a></li>
<li class="chapter" data-level="17.7.8" data-path="cluster-analysis.html"><a href="cluster-analysis.html#as.dendrogram"><i class="fa fa-check"></i><b>17.7.8</b> <code>as.dendrogram()</code></a></li>
<li class="chapter" data-level="17.7.9" data-path="cluster-analysis.html"><a href="cluster-analysis.html#modify-the-labels"><i class="fa fa-check"></i><b>17.7.9</b> Modify the Labels</a></li>
<li class="chapter" data-level="17.7.10" data-path="cluster-analysis.html"><a href="cluster-analysis.html#color-the-branches"><i class="fa fa-check"></i><b>17.7.10</b> Color the Branches</a></li>
<li class="chapter" data-level="17.7.11" data-path="cluster-analysis.html"><a href="cluster-analysis.html#cluster-assignments-k-3"><i class="fa fa-check"></i><b>17.7.11</b> Cluster Assignments (<span class="math inline">\(K = 3\)</span>)</a></li>
<li class="chapter" data-level="17.7.12" data-path="cluster-analysis.html"><a href="cluster-analysis.html#cluster-assignments-k-3-1"><i class="fa fa-check"></i><b>17.7.12</b> Cluster Assignments (<span class="math inline">\(K = 3\)</span>)</a></li>
<li class="chapter" data-level="17.7.13" data-path="cluster-analysis.html"><a href="cluster-analysis.html#cluster-assignments-k-2"><i class="fa fa-check"></i><b>17.7.13</b> Cluster Assignments (<span class="math inline">\(K = 2\)</span>)</a></li>
<li class="chapter" data-level="17.7.14" data-path="cluster-analysis.html"><a href="cluster-analysis.html#cluster-assignments-k-4"><i class="fa fa-check"></i><b>17.7.14</b> Cluster Assignments (<span class="math inline">\(K = 4\)</span>)</a></li>
<li class="chapter" data-level="17.7.15" data-path="cluster-analysis.html"><a href="cluster-analysis.html#cluster-assignments-k-6"><i class="fa fa-check"></i><b>17.7.15</b> Cluster Assignments (<span class="math inline">\(K = 6\)</span>)</a></li>
<li class="chapter" data-level="17.7.16" data-path="cluster-analysis.html"><a href="cluster-analysis.html#linkage-complete-default"><i class="fa fa-check"></i><b>17.7.16</b> Linkage: Complete (Default)</a></li>
<li class="chapter" data-level="17.7.17" data-path="cluster-analysis.html"><a href="cluster-analysis.html#linkage-average"><i class="fa fa-check"></i><b>17.7.17</b> Linkage: Average</a></li>
<li class="chapter" data-level="17.7.18" data-path="cluster-analysis.html"><a href="cluster-analysis.html#linkage-single"><i class="fa fa-check"></i><b>17.7.18</b> Linkage: Single</a></li>
<li class="chapter" data-level="17.7.19" data-path="cluster-analysis.html"><a href="cluster-analysis.html#linkage-ward"><i class="fa fa-check"></i><b>17.7.19</b> Linkage: Ward</a></li>
<li class="chapter" data-level="17.7.20" data-path="cluster-analysis.html"><a href="cluster-analysis.html#hierarchical-clustering-of-data2"><i class="fa fa-check"></i><b>17.7.20</b> Hierarchical Clustering of <code>data2</code></a></li>
<li class="chapter" data-level="17.7.21" data-path="cluster-analysis.html"><a href="cluster-analysis.html#as.dendrogram-1"><i class="fa fa-check"></i><b>17.7.21</b> <code>as.dendrogram()</code></a></li>
<li class="chapter" data-level="17.7.22" data-path="cluster-analysis.html"><a href="cluster-analysis.html#modify-the-labels-1"><i class="fa fa-check"></i><b>17.7.22</b> Modify the Labels</a></li>
<li class="chapter" data-level="17.7.23" data-path="cluster-analysis.html"><a href="cluster-analysis.html#color-the-branches-1"><i class="fa fa-check"></i><b>17.7.23</b> Color the Branches</a></li>
<li class="chapter" data-level="17.7.24" data-path="cluster-analysis.html"><a href="cluster-analysis.html#cluster-assignments-k-2-1"><i class="fa fa-check"></i><b>17.7.24</b> Cluster Assignments (<span class="math inline">\(K = 2\)</span>)</a></li>
<li class="chapter" data-level="17.7.25" data-path="cluster-analysis.html"><a href="cluster-analysis.html#cluster-assignments-k-3-2"><i class="fa fa-check"></i><b>17.7.25</b> Cluster Assignments (<span class="math inline">\(K = 3\)</span>)</a></li>
<li class="chapter" data-level="17.7.26" data-path="cluster-analysis.html"><a href="cluster-analysis.html#cluster-assignments-k-4-1"><i class="fa fa-check"></i><b>17.7.26</b> Cluster Assignments (<span class="math inline">\(K = 4\)</span>)</a></li>
<li class="chapter" data-level="17.7.27" data-path="cluster-analysis.html"><a href="cluster-analysis.html#cluster-assignments-k-5"><i class="fa fa-check"></i><b>17.7.27</b> Cluster Assignments (<span class="math inline">\(K = 5\)</span>)</a></li>
</ul></li>
<li class="chapter" data-level="17.8" data-path="cluster-analysis.html"><a href="cluster-analysis.html#k-means-clustering"><i class="fa fa-check"></i><b>17.8</b> K-Means Clustering</a><ul>
<li class="chapter" data-level="17.8.1" data-path="cluster-analysis.html"><a href="cluster-analysis.html#strategy-1"><i class="fa fa-check"></i><b>17.8.1</b> Strategy</a></li>
<li class="chapter" data-level="17.8.2" data-path="cluster-analysis.html"><a href="cluster-analysis.html#centroid"><i class="fa fa-check"></i><b>17.8.2</b> Centroid</a></li>
<li class="chapter" data-level="17.8.3" data-path="cluster-analysis.html"><a href="cluster-analysis.html#algorithm-1"><i class="fa fa-check"></i><b>17.8.3</b> Algorithm</a></li>
<li class="chapter" data-level="17.8.4" data-path="cluster-analysis.html"><a href="cluster-analysis.html#notes"><i class="fa fa-check"></i><b>17.8.4</b> Notes</a></li>
<li class="chapter" data-level="17.8.5" data-path="cluster-analysis.html"><a href="cluster-analysis.html#kmeans"><i class="fa fa-check"></i><b>17.8.5</b> <code>kmeans()</code></a></li>
<li class="chapter" data-level="17.8.6" data-path="cluster-analysis.html"><a href="cluster-analysis.html#fitted"><i class="fa fa-check"></i><b>17.8.6</b> <code>fitted()</code></a></li>
<li class="chapter" data-level="17.8.7" data-path="cluster-analysis.html"><a href="cluster-analysis.html#k-means-clustering-of-data1"><i class="fa fa-check"></i><b>17.8.7</b> K-Means Clustering of <code>data1</code></a></li>
<li class="chapter" data-level="17.8.8" data-path="cluster-analysis.html"><a href="cluster-analysis.html#centroids-of-data1"><i class="fa fa-check"></i><b>17.8.8</b> Centroids of <code>data1</code></a></li>
<li class="chapter" data-level="17.8.9" data-path="cluster-analysis.html"><a href="cluster-analysis.html#cluster-assignments-k-3-3"><i class="fa fa-check"></i><b>17.8.9</b> Cluster Assignments (<span class="math inline">\(K = 3\)</span>)</a></li>
<li class="chapter" data-level="17.8.10" data-path="cluster-analysis.html"><a href="cluster-analysis.html#cluster-assignments-k-2-2"><i class="fa fa-check"></i><b>17.8.10</b> Cluster Assignments (<span class="math inline">\(K = 2\)</span>)</a></li>
<li class="chapter" data-level="17.8.11" data-path="cluster-analysis.html"><a href="cluster-analysis.html#cluster-assignments-k-6-1"><i class="fa fa-check"></i><b>17.8.11</b> Cluster Assignments (<span class="math inline">\(K = 6\)</span>)</a></li>
<li class="chapter" data-level="17.8.12" data-path="cluster-analysis.html"><a href="cluster-analysis.html#k-means-clustering-of-data2"><i class="fa fa-check"></i><b>17.8.12</b> K-Means Clustering of <code>data2</code></a></li>
<li class="chapter" data-level="17.8.13" data-path="cluster-analysis.html"><a href="cluster-analysis.html#cluster-assignments-k-2-3"><i class="fa fa-check"></i><b>17.8.13</b> Cluster Assignments (<span class="math inline">\(K = 2\)</span>)</a></li>
<li class="chapter" data-level="17.8.14" data-path="cluster-analysis.html"><a href="cluster-analysis.html#cluster-assignments-k-3-4"><i class="fa fa-check"></i><b>17.8.14</b> Cluster Assignments (<span class="math inline">\(K = 3\)</span>)</a></li>
<li class="chapter" data-level="17.8.15" data-path="cluster-analysis.html"><a href="cluster-analysis.html#cluster-assignments-k-5-1"><i class="fa fa-check"></i><b>17.8.15</b> Cluster Assignments (<span class="math inline">\(K = 5\)</span>)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="18" data-path="principal-component-analysis.html"><a href="principal-component-analysis.html"><i class="fa fa-check"></i><b>18</b> Principal Component Analysis</a><ul>
<li class="chapter" data-level="18.1" data-path="principal-component-analysis.html"><a href="principal-component-analysis.html#dimensionality-reduction"><i class="fa fa-check"></i><b>18.1</b> Dimensionality Reduction</a></li>
<li class="chapter" data-level="18.2" data-path="principal-component-analysis.html"><a href="principal-component-analysis.html#goal-of-pca"><i class="fa fa-check"></i><b>18.2</b> Goal of PCA</a></li>
<li class="chapter" data-level="18.3" data-path="principal-component-analysis.html"><a href="principal-component-analysis.html#defining-the-first-pc"><i class="fa fa-check"></i><b>18.3</b> Defining the First PC</a></li>
<li class="chapter" data-level="18.4" data-path="principal-component-analysis.html"><a href="principal-component-analysis.html#calculating-all-pcs"><i class="fa fa-check"></i><b>18.4</b> Calculating All PCs</a></li>
<li class="chapter" data-level="18.5" data-path="principal-component-analysis.html"><a href="principal-component-analysis.html#singular-value-decomposition"><i class="fa fa-check"></i><b>18.5</b> Singular Value Decomposition</a></li>
<li class="chapter" data-level="18.6" data-path="principal-component-analysis.html"><a href="principal-component-analysis.html#a-simple-pca-function"><i class="fa fa-check"></i><b>18.6</b> A Simple PCA Function</a></li>
<li class="chapter" data-level="18.7" data-path="principal-component-analysis.html"><a href="principal-component-analysis.html#the-ubiquitous-pca-example"><i class="fa fa-check"></i><b>18.7</b> The Ubiquitous PCA Example</a></li>
<li class="chapter" data-level="18.8" data-path="principal-component-analysis.html"><a href="principal-component-analysis.html#pc-biplots"><i class="fa fa-check"></i><b>18.8</b> PC Biplots</a></li>
<li class="chapter" data-level="18.9" data-path="principal-component-analysis.html"><a href="principal-component-analysis.html#pca-examples"><i class="fa fa-check"></i><b>18.9</b> PCA Examples</a><ul>
<li class="chapter" data-level="18.9.1" data-path="principal-component-analysis.html"><a href="principal-component-analysis.html#weather-data"><i class="fa fa-check"></i><b>18.9.1</b> Weather Data</a></li>
<li class="chapter" data-level="18.9.2" data-path="principal-component-analysis.html"><a href="principal-component-analysis.html#yeast-gene-expression"><i class="fa fa-check"></i><b>18.9.2</b> Yeast Gene Expression</a></li>
<li class="chapter" data-level="18.9.3" data-path="principal-component-analysis.html"><a href="principal-component-analysis.html#hapmap-genotypes"><i class="fa fa-check"></i><b>18.9.3</b> HapMap Genotypes</a></li>
</ul></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Yet Another R Primer!</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="principal-component-analysis" class="section level1">
<h1><span class="header-section-number">18</span> Principal Component Analysis</h1>
<div id="dimensionality-reduction" class="section level2">
<h2><span class="header-section-number">18.1</span> Dimensionality Reduction</h2>
<p>The goal of <strong>dimensionality reduction</strong> is to extract low dimensional representations of high dimensional data that are useful for visualization, exploration, inference, or prediction.</p>
<p>The low dimensional representations should capture key sources of variation in the data.</p>
<p>Some methods for dimensionality reduction include:</p>
<ul>
<li>Principal component analysis</li>
<li>Singular value decomposition</li>
<li>Latent variable modeling</li>
<li>Vector quantization</li>
<li>Self-organizing maps</li>
<li>Multidimensional scaling</li>
</ul>
<p>We will focus on what is likely the most commonly applied dimensionality reduction tool, principal components analysis.</p>
</div>
<div id="goal-of-pca" class="section level2">
<h2><span class="header-section-number">18.2</span> Goal of PCA</h2>
<p>For a given set of variables, <strong>principal component analysis</strong> (PCA) finds (constrained) weighted sums of the variables to produce variables (called principal components) that capture consectuive maximum levels of variation in the data.</p>
<p>Specifically, the first principal component is the weighted sum of the variables that results in a component with the highest variation.</p>
<p>This component is then “removed” from the data, and the second principal component is obtained on the resulting residuals.</p>
<p>This process is repeated until there is no variation left in the data.</p>
</div>
<div id="defining-the-first-pc" class="section level2">
<h2><span class="header-section-number">18.3</span> Defining the First PC</h2>
<p>Suppose we have <span class="math inline">\(m\)</span> variables, each with <span class="math inline">\(n\)</span> observations:</p>
<p><span class="math display">\[
\begin{aligned}
{\boldsymbol{x}}_1 &amp; = (x_{11}, x_{12}, \ldots, x_{1n}) \\
{\boldsymbol{x}}_2 &amp; = (x_{21}, x_{22}, \ldots, x_{2n}) \\
\  &amp; \vdots \ \\
{\boldsymbol{x}}_m &amp; = (x_{m1}, x_{m2}, \ldots, x_{mn})
\end{aligned}
\]</span></p>
<p>We can organize these variables into an <span class="math inline">\(m \times n\)</span> matrix <span class="math inline">\({\boldsymbol{X}}\)</span> where row <span class="math inline">\(i\)</span> is <span class="math inline">\({\boldsymbol{x}}_i\)</span>.</p>
<p>Consider all possible weighted sums of these variables</p>
<p><span class="math display">\[\tilde{\pmb{x}} = \sum_{i=1}^{m} u_i \pmb{x}_i\]</span></p>
<p>where we constrain <span class="math inline">\(\sum_{i=1}^{m} u_i^2 = 1\)</span>. We wish to identify the vector <span class="math inline">\(\pmb{u} = \{u_i\}_{i=1}^{m}\)</span> under this constraint that maximizes the sample variance of <span class="math inline">\(\tilde{\pmb{x}}\)</span>. However, note that if we first mean center each variable, replacing <span class="math inline">\(x_{ij}\)</span> with <span class="math display">\[x_{ij}^* = x_{ij} -  \frac{1}{n} \sum_{k=1}^n x_{ik},\]</span> then the sample variance of <span class="math inline">\(\tilde{\pmb{x}} = \sum_{i=1}^{m} u_i \pmb{x}_i\)</span> is equal to that of <span class="math inline">\(\tilde{\pmb{x}}^* = \sum_{i=1}^{m} u_i \pmb{x}^*_i\)</span>.</p>
<p>PCA is a method concerned with decompositon variance and covariance, so we don’t wish to involve the mean of each indivdual variable. Therefore, unless the true population mean of each variable is known (in which case it would be subtracted from its respective variable), we will formulate PCA in terms of mean centered variables, <span class="math inline">\(\pmb{x}^*_i = (x^*_{i1}, x^*_{i2}, \ldots, x^*_{in})\)</span>, which we can collect into <span class="math inline">\(m \times n\)</span> matrix <span class="math inline">\({\boldsymbol{X}}^*\)</span>. We therefore consider all possible weighted sums of variables: <span class="math display">\[\tilde{\pmb{x}}^* = \sum_{i=1}^{m} u_i \pmb{x}^*_i.\]</span></p>
<p>The <strong>first principal component</strong> of <span class="math inline">\({\boldsymbol{X}}^*\)</span> (and <span class="math inline">\({\boldsymbol{X}}\)</span>) is <span class="math inline">\(\tilde{\pmb{x}}^*\)</span> with maximum sample variance</p>
<p><span class="math display">\[
s^2_{\tilde{{\boldsymbol{x}}}^*}  = \frac{\sum_{j=1}^n \tilde{x}^{*2}_j}{n-1} 
\]</span></p>
<p>The <span class="math inline">\(\pmb{u} = \{u_i\}_{i=1}^{m}\)</span> yielding this first principal component is called its <strong>loadings</strong>.</p>
<p>Note that <span class="math display">\[
s^2_{\tilde{{\boldsymbol{x}}}}  = \frac{\sum_{j=1}^n \left(\tilde{x}_j - \frac{1}{n} \sum_{k=1}^n \tilde{x}_k \right)^2}{n-1} = \frac{\sum_{j=1}^n \tilde{x}^{*2}_j}{n-1} = s^2_{\tilde{{\boldsymbol{x}}}^*} \ ,
\]</span> so the loadings can be found from either <span class="math inline">\({\boldsymbol{X}}\)</span> or <span class="math inline">\({\boldsymbol{X}}^*\)</span>. However, it the technically correct first PC is <span class="math inline">\(\tilde{{\boldsymbol{x}}}^*\)</span> rather than <span class="math inline">\(\tilde{{\boldsymbol{x}}}\)</span>.</p>
<p>This first PC is then removed from the data, and the procedure is repeated until all possible sample PCs are constructed. This is accomplished by calculating the product of <span class="math inline">\({\boldsymbol{u}}_{m \times 1}\)</span> and <span class="math inline">\(\tilde{\pmb{x}}^*_{1 \times n}\)</span>, and subtracting it from <span class="math inline">\({\boldsymbol{X}}^*\)</span>: <span class="math display">\[
{\boldsymbol{X}}^* - {\boldsymbol{u}}\tilde{\pmb{x}}^* \ .
\]</span></p>
</div>
<div id="calculating-all-pcs" class="section level2">
<h2><span class="header-section-number">18.4</span> Calculating All PCs</h2>
<p>All of the PCs can be calculated simultaneously. First, we construct the <span class="math inline">\(m \times m\)</span> sample covariance matrix <span class="math inline">\({\boldsymbol{S}}\)</span> with <span class="math inline">\((i,j)\)</span> entry <span class="math display">\[
s_{ij} = \frac{\sum_{k=1}^n (x_{ik} - \bar{x}_{i\cdot})(x_{jk} - \bar{x}_{j\cdot})}{n-1}.
\]</span> The sample covariance can also be calculated by <span class="math display">\[
{\boldsymbol{S}}= \frac{1}{n-1} {\boldsymbol{X}}^{*} {\boldsymbol{X}}^{*T}.
\]</span></p>
<p>It can be shown that <span class="math display">\[
s^2_{\tilde{{\boldsymbol{x}}}^*} = {\boldsymbol{u}}^T {\boldsymbol{S}}{\boldsymbol{u}},
\]</span> so identifying <span class="math inline">\({\boldsymbol{u}}\)</span> that maximizes <span class="math inline">\(s^2_{\tilde{{\boldsymbol{x}}}}\)</span> also maximizes <span class="math inline">\({\boldsymbol{u}}^T {\boldsymbol{S}}{\boldsymbol{u}}\)</span>.</p>
<p>Using a Lagrange multiplier, we wish to maximize</p>
<p><span class="math display">\[
{\boldsymbol{u}}^T {\boldsymbol{S}}{\boldsymbol{u}}+ \lambda({\boldsymbol{u}}^T {\boldsymbol{u}}- 1).
\]</span></p>
<p>Differentiating with respect to <span class="math inline">\({\boldsymbol{u}}\)</span> and setting this to <span class="math inline">\({\boldsymbol{0}}\)</span>, we get <span class="math inline">\({\boldsymbol{S}}{\boldsymbol{u}}- \lambda {\boldsymbol{u}}= 0\)</span> or</p>
<p><span class="math display">\[
{\boldsymbol{S}}{\boldsymbol{u}}= \lambda {\boldsymbol{u}}.
\]</span></p>
<p>For any such <span class="math inline">\({\boldsymbol{u}}\)</span> and <span class="math inline">\(\lambda\)</span> where this holds, note that</p>
<p><span class="math display">\[
s_{ij} = \frac{\sum_{k=1}^n (x_{ik} - \bar{x}_{i\cdot})(x_{jk} - \bar{x}_{j\cdot})}{n-1} = {\boldsymbol{u}}^T {\boldsymbol{S}}{\boldsymbol{u}}= \lambda
\]</span></p>
<p>so the PC’s variance is <span class="math inline">\(\lambda\)</span>.</p>
<p>The eigendecompositon of a matrix identifies all such solutions to <span class="math inline">\({\boldsymbol{S}}{\boldsymbol{u}}= \lambda {\boldsymbol{u}}.\)</span> Specifically, it calculates the decompositon</p>
<p><span class="math display">\[
{\boldsymbol{S}}= {\boldsymbol{U}}{\boldsymbol{\Lambda}}{\boldsymbol{U}}^T
\]</span></p>
<p>where <span class="math inline">\({\boldsymbol{U}}\)</span> is an <span class="math inline">\(m \times m\)</span> orthogonal matrix and <span class="math inline">\({\boldsymbol{\Lambda}}\)</span> is a diagonal matrix with entries <span class="math inline">\(\lambda_1 \geq \lambda_2 \geq \cdots \geq \lambda_m \geq 0\)</span>.</p>
<p>The fact that <span class="math inline">\({\boldsymbol{U}}\)</span> is orthogonal means <span class="math inline">\({\boldsymbol{U}}{\boldsymbol{U}}^T = {\boldsymbol{U}}^T {\boldsymbol{U}}= {\boldsymbol{I}}\)</span>.</p>
<p>The following therefore hold:</p>
<ul>
<li>For each column <span class="math inline">\(j\)</span> of <span class="math inline">\({\boldsymbol{U}}\)</span>, say <span class="math inline">\({\boldsymbol{u}}_j\)</span>, it follows that <span class="math inline">\({\boldsymbol{S}}{\boldsymbol{u}}_j = \lambda_j {\boldsymbol{u}}_j\)</span></li>
<li><span class="math inline">\(\| {\boldsymbol{u}}_j \|^2_2 = 1\)</span> and <span class="math inline">\({\boldsymbol{u}}_j^T {\boldsymbol{u}}_k = {\boldsymbol{0}}\)</span> for <span class="math inline">\(\lambda_j \not= \lambda_k\)</span></li>
<li><span class="math inline">\({\operatorname{Var}}({\boldsymbol{u}}_j^T {\boldsymbol{X}}) = \lambda_j\)</span></li>
<li><span class="math inline">\({\operatorname{Var}}({\boldsymbol{u}}_1^T {\boldsymbol{X}}) \geq {\operatorname{Var}}({\boldsymbol{u}}_2^T {\boldsymbol{X}}) \geq \cdots \geq {\operatorname{Var}}({\boldsymbol{u}}_m^T {\boldsymbol{X}})\)</span></li>
<li><span class="math inline">\({\boldsymbol{S}}= \sum_{j=1}^m \lambda_j {\boldsymbol{u}}_j {\boldsymbol{u}}_j^T\)</span></li>
<li>For <span class="math inline">\(\lambda_j \not= \lambda_k\)</span>, <span class="math display">\[{\operatorname{Cov}}({\boldsymbol{u}}_j^T {\boldsymbol{X}}, {\boldsymbol{u}}_k^T {\boldsymbol{X}}) = {\boldsymbol{u}}_j^T {\boldsymbol{S}}{\boldsymbol{u}}_k = \lambda_k {\boldsymbol{u}}_j^T {\boldsymbol{u}}_k =  {\boldsymbol{0}}\]</span></li>
</ul>
<p>To calculate the actual principal components, let <span class="math inline">\(x^*_{ij} = x_{ij} - \bar{x}_{i\cdot}\)</span> be the mean-centered variables. Let <span class="math inline">\({\boldsymbol{X}}^*\)</span> be the matrix composed of these mean-centered variables. Also, let <span class="math inline">\({\boldsymbol{u}}_j\)</span> be column <span class="math inline">\(j\)</span> of <span class="math inline">\({\boldsymbol{U}}\)</span> from <span class="math inline">\({\boldsymbol{S}}= {\boldsymbol{U}}{\boldsymbol{\Lambda}}{\boldsymbol{U}}^T\)</span>.</p>
<p><strong>Sample principal component</strong> <span class="math inline">\(j\)</span> is then</p>
<p><span class="math display">\[
\tilde{{\boldsymbol{x}}}_j = {\boldsymbol{u}}_j^T {\boldsymbol{X}}^* = \sum_{i=1}^m u_{ij} {\boldsymbol{x}}^*_i 
\]</span></p>
<p>for <span class="math inline">\(j = 1, 2, \ldots, \min(m, n-1)\)</span>. For <span class="math inline">\(j &gt; \min(m, n-1)\)</span>, we have <span class="math inline">\(\lambda_j = 0\)</span>, so these principal components are not necessary to calculate. The <strong>loadings</strong> corresponding to PC <span class="math inline">\(j\)</span> are <span class="math inline">\({\boldsymbol{u}}_j\)</span>.</p>
<p>Note that the convention is that mean of PC <span class="math inline">\(j\)</span> is zero, i.e., that <span class="math display">\[
\frac{1}{n} \sum_{k=1}^n \tilde{x}_{jk} = 0,
\]</span> but as mentioned above <span class="math inline">\(\sum_{i=1}^m u_{ij} {\boldsymbol{x}}^*_i\)</span> and the uncentered <span class="math inline">\(\sum_{i=1}^m u_{ij} {\boldsymbol{x}}_i\)</span> have the same sample variance.</p>
<p>It can be calculated that the variance of PC <span class="math inline">\(j\)</span> is <span class="math display">\[
s^2_{\tilde{{\boldsymbol{x}}}_j} = \frac{\sum_{k=1}^n \tilde{x}_{jk}^2}{n-1} = \lambda_j.
\]</span> The proportion of variance explained by PC <span class="math inline">\(j\)</span> is <span class="math display">\[
\operatorname{PVE}_j = \frac{\lambda_j}{\sum_{k=1}^m \lambda_k}.
\]</span></p>
</div>
<div id="singular-value-decomposition" class="section level2">
<h2><span class="header-section-number">18.5</span> Singular Value Decomposition</h2>
<p>One way in which PCA is performed is to carry out a <strong>singular value decomposition</strong> (SVD) of the data matrix <span class="math inline">\({\boldsymbol{X}}\)</span>. Let <span class="math inline">\(q = \min(m, n)\)</span>. Recalling that <span class="math inline">\({\boldsymbol{X}}^*\)</span> is the row-wise mean centered <span class="math inline">\({\boldsymbol{X}}\)</span>, we can take the SVD of <span class="math inline">\({\boldsymbol{X}}^*/\sqrt{n-1}\)</span> to obtain</p>
<p><span class="math display">\[
\frac{1}{\sqrt{n-1}} {\boldsymbol{X}}^* = {\boldsymbol{U}}{\boldsymbol{D}}{\boldsymbol{V}}^T
\]</span></p>
<p>where <span class="math inline">\({\boldsymbol{U}}_{m \times q}\)</span>, <span class="math inline">\({\boldsymbol{V}}_{n \times q}\)</span>, and diagonal <span class="math inline">\({\boldsymbol{D}}_{q \times q}\)</span>. Also, we have the orthogonality properties <span class="math inline">\({\boldsymbol{V}}^T {\boldsymbol{V}}= {\boldsymbol{U}}^T {\boldsymbol{U}}= {\boldsymbol{I}}_{q}\)</span>. Finally, <span class="math inline">\({\boldsymbol{D}}\)</span> is composed of diagonal elements <span class="math inline">\(d_1 \geq d_2 \geq \cdots \geq d_q \geq 0\)</span> where <span class="math inline">\(d_q = 0\)</span> if <span class="math inline">\(q = n\)</span>.</p>
<p>Note that</p>
<p><span class="math display">\[
{\boldsymbol{S}}= \frac{1}{n-1} {\boldsymbol{X}}^{*} {\boldsymbol{X}}^{*T} = {\boldsymbol{U}}{\boldsymbol{D}}{\boldsymbol{V}}^T \left({\boldsymbol{U}}{\boldsymbol{D}}{\boldsymbol{V}}^T\right)^T = {\boldsymbol{U}}{\boldsymbol{D}}^2 {\boldsymbol{U}}^T.
\]</span></p>
<p>Therefore:</p>
<ul>
<li>The variance of PC <span class="math inline">\(j\)</span> is <span class="math inline">\(\lambda_j = d_j^2\)</span></li>
<li>The loadings of PC <span class="math inline">\(j\)</span> are contained in the columns of the left-hand matrix from the decomposition of <span class="math inline">\({\boldsymbol{S}}\)</span> or <span class="math inline">\({\boldsymbol{X}}^*\)</span></li>
<li>PC <span class="math inline">\(j\)</span> is row <span class="math inline">\(j\)</span> of <span class="math inline">\({\boldsymbol{D}}{\boldsymbol{V}}^T\)</span></li>
</ul>
</div>
<div id="a-simple-pca-function" class="section level2">
<h2><span class="header-section-number">18.6</span> A Simple PCA Function</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="op">&gt;</span><span class="st"> </span>pca &lt;-<span class="st"> </span><span class="cf">function</span>(x, <span class="dt">space=</span><span class="kw">c</span>(<span class="st">&quot;rows&quot;</span>, <span class="st">&quot;columns&quot;</span>), 
<span class="op">+</span><span class="st">                 </span><span class="dt">center=</span><span class="ot">TRUE</span>, <span class="dt">scale=</span><span class="ot">FALSE</span>) {
<span class="op">+</span><span class="st">   </span>space &lt;-<span class="st"> </span><span class="kw">match.arg</span>(space)
<span class="op">+</span><span class="st">   </span><span class="cf">if</span>(space<span class="op">==</span><span class="st">&quot;columns&quot;</span>) {x &lt;-<span class="st"> </span><span class="kw">t</span>(x)}
<span class="op">+</span><span class="st">   </span>x &lt;-<span class="st"> </span><span class="kw">t</span>(<span class="kw">scale</span>(<span class="kw">t</span>(x), <span class="dt">center=</span>center, <span class="dt">scale=</span>scale))
<span class="op">+</span><span class="st">   </span>x &lt;-<span class="st"> </span>x<span class="op">/</span><span class="kw">sqrt</span>(<span class="kw">nrow</span>(x)<span class="op">-</span><span class="dv">1</span>)
<span class="op">+</span><span class="st">   </span>s &lt;-<span class="st"> </span><span class="kw">svd</span>(x)
<span class="op">+</span><span class="st">   </span>loading &lt;-<span class="st"> </span>s<span class="op">$</span>u
<span class="op">+</span><span class="st">   </span><span class="kw">colnames</span>(loading) &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&quot;Loading&quot;</span>, <span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(loading))
<span class="op">+</span><span class="st">   </span><span class="kw">rownames</span>(loading) &lt;-<span class="st"> </span><span class="kw">rownames</span>(x)
<span class="op">+</span><span class="st">   </span>pc &lt;-<span class="st"> </span><span class="kw">diag</span>(s<span class="op">$</span>d) <span class="op">%*%</span><span class="st"> </span><span class="kw">t</span>(s<span class="op">$</span>v)
<span class="op">+</span><span class="st">   </span><span class="kw">rownames</span>(pc) &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&quot;PC&quot;</span>, <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(pc))
<span class="op">+</span><span class="st">   </span><span class="kw">colnames</span>(pc) &lt;-<span class="st"> </span><span class="kw">colnames</span>(x)
<span class="op">+</span><span class="st">   </span>pve &lt;-<span class="st"> </span>s<span class="op">$</span>d<span class="op">^</span><span class="dv">2</span> <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(s<span class="op">$</span>d<span class="op">^</span><span class="dv">2</span>)
<span class="op">+</span><span class="st">   </span><span class="cf">if</span>(space<span class="op">==</span><span class="st">&quot;columns&quot;</span>) {pc &lt;-<span class="st"> </span><span class="kw">t</span>(pc); loading &lt;-<span class="st"> </span><span class="kw">t</span>(loading)}
<span class="op">+</span><span class="st">   </span><span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">pc=</span>pc, <span class="dt">loading=</span>loading, <span class="dt">pve=</span>pve))
<span class="op">+</span><span class="st"> </span>}</code></pre></div>
<p>The input is as follows:</p>
<ul>
<li><code>x</code>: a matrix of numerical values</li>
<li><code>space</code>: either <code>&quot;rows&quot;</code> or <code>&quot;columns&quot;</code>, denoting which dimension contains the variables</li>
<li><code>center</code>: if <code>TRUE</code> then the variables are mean centered before calculating PCs</li>
<li><code>scale</code>: if <code>TRUE</code> then the variables are std dev scaled before calculating PCs</li>
</ul>
<p>The output is a list with the following items:</p>
<ul>
<li><code>pc</code>: a matrix of all possible PCs</li>
<li><code>loading</code>: the weights or “loadings” that determined each PC</li>
<li><code>pve</code>: the proportion of variation explained by each PC</li>
</ul>
<p>Note that the rows or columns of <code>pc</code> and <code>loading</code> have names to let you know on which dimension the values are organized.</p>
</div>
<div id="the-ubiquitous-pca-example" class="section level2">
<h2><span class="header-section-number">18.7</span> The Ubiquitous PCA Example</h2>
<p>Here’s an example very frequently encountered to explain PCA, but it’s slightly complicated and conflates several ideas in PCA. I think it’s not a great example to motivate PCA, but it’s so common I want to carefully clarify what it’s displaying.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="op">&gt;</span><span class="st"> </span><span class="kw">set.seed</span>(<span class="dv">508</span>)
<span class="op">&gt;</span><span class="st"> </span>n &lt;-<span class="st"> </span><span class="dv">70</span>
<span class="op">&gt;</span><span class="st"> </span>z &lt;-<span class="st"> </span><span class="kw">sqrt</span>(<span class="fl">0.8</span>) <span class="op">*</span><span class="st"> </span><span class="kw">rnorm</span>(n)
<span class="op">&gt;</span><span class="st"> </span>x1 &lt;-<span class="st"> </span>z <span class="op">+</span><span class="st"> </span><span class="kw">sqrt</span>(<span class="fl">0.2</span>) <span class="op">*</span><span class="st"> </span><span class="kw">rnorm</span>(n)
<span class="op">&gt;</span><span class="st"> </span>x2 &lt;-<span class="st"> </span>z <span class="op">+</span><span class="st"> </span><span class="kw">sqrt</span>(<span class="fl">0.2</span>) <span class="op">*</span><span class="st"> </span><span class="kw">rnorm</span>(n)
<span class="op">&gt;</span><span class="st"> </span>X &lt;-<span class="st"> </span><span class="kw">rbind</span>(x1, x2)
<span class="op">&gt;</span><span class="st"> </span>p &lt;-<span class="st"> </span><span class="kw">pca</span>(<span class="dt">x=</span>X, <span class="dt">space=</span><span class="st">&quot;rows&quot;</span>)</code></pre></div>
<p>PCS is often explained by showing the following plot and stating, “The first PC finds the direction of maximal variance in the data…”</p>
<p><img src="eda_files/figure-html/unnamed-chunk-178-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>The above figure was made with the following code:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="op">&gt;</span><span class="st"> </span>a1 &lt;-<span class="st"> </span>p<span class="op">$</span>loading[<span class="dv">1</span>,<span class="dv">1</span>] <span class="op">*</span><span class="st"> </span>p<span class="op">$</span>pc[<span class="dv">1</span>,] <span class="op">+</span><span class="st"> </span><span class="kw">mean</span>(x1)
<span class="op">&gt;</span><span class="st"> </span>a2 &lt;-<span class="st"> </span>p<span class="op">$</span>loading[<span class="dv">1</span>,<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>p<span class="op">$</span>pc[<span class="dv">1</span>,] <span class="op">+</span><span class="st"> </span><span class="kw">mean</span>(x2)
<span class="op">&gt;</span><span class="st"> </span>df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">x1=</span><span class="kw">c</span>(x1, a1), 
<span class="op">+</span><span class="st">                  </span><span class="dt">x2=</span><span class="kw">c</span>(x2, a2), 
<span class="op">+</span><span class="st">                  </span><span class="dt">legend=</span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">&quot;data&quot;</span>,n),<span class="kw">rep</span>(<span class="st">&quot;pc1_projection&quot;</span>,n)))
<span class="op">&gt;</span><span class="st"> </span><span class="kw">ggplot</span>(df) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x=</span>x1,<span class="dt">y=</span>x2,<span class="dt">color=</span>legend)) <span class="op">+</span><span class="st"> </span>
<span class="op">+</span><span class="st">   </span><span class="kw">scale_color_manual</span>(<span class="dt">values=</span><span class="kw">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;red&quot;</span>))</code></pre></div>
<p>The red dots are therefore the projection of <code>x1</code> and <code>x2</code> onto the first PC, so they are neither the loadings nor the PC. This is rather complicated to understand before loadings and PCs are full understood.</p>
<p>Note that there are several ways to calculate these projections.</p>
<pre><code># all equivalent ways to get a1  
p$loading[1,1] * p$pc[1,]
outer(p$loading[,1], p$pc[1,])[1,] + mean(x1) 
lm(x1 ~ p$pc[1,])$fit # and

# all equivalent ways to get a2  
p$loading[2,2] * p$pc[2,]
outer(p$loading[,1], p$pc[1,])[2,] + mean(x2) 
lm(x2 ~ p$pc[1,])$fit</code></pre>
<p>We haven’t seen the <code>lm()</code> function yet, but once we do this example will be useful to revisit to understand what is meant by “projection”.</p>
<p>Here is PC1 vs PC2:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="op">&gt;</span><span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">pc1=</span>p<span class="op">$</span>pc[<span class="dv">1</span>,], <span class="dt">pc2=</span>p<span class="op">$</span>pc[<span class="dv">2</span>,]) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="op">+</span><span class="st">   </span><span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x=</span>pc1,<span class="dt">y=</span>pc2)) <span class="op">+</span><span class="st"> </span>
<span class="op">+</span><span class="st">   </span><span class="kw">theme</span>(<span class="dt">aspect.ratio=</span><span class="dv">1</span>)</code></pre></div>
<p><img src="eda_files/figure-html/unnamed-chunk-180-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Here is PC1 vs <code>x1</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="op">&gt;</span><span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">pc1=</span>p<span class="op">$</span>pc[<span class="dv">1</span>,], <span class="dt">x1=</span>x1) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="op">+</span><span class="st">   </span><span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x=</span>pc1,<span class="dt">y=</span>x1)) <span class="op">+</span><span class="st"> </span>
<span class="op">+</span><span class="st">   </span><span class="kw">theme</span>(<span class="dt">aspect.ratio=</span><span class="dv">1</span>)</code></pre></div>
<p><img src="eda_files/figure-html/unnamed-chunk-181-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Here is PC1 vs <code>x2</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="op">&gt;</span><span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">pc1=</span>p<span class="op">$</span>pc[<span class="dv">1</span>,], <span class="dt">x2=</span>x2) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="op">+</span><span class="st">   </span><span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x=</span>pc1,<span class="dt">y=</span>x2)) <span class="op">+</span><span class="st"> </span>
<span class="op">+</span><span class="st">   </span><span class="kw">theme</span>(<span class="dt">aspect.ratio=</span><span class="dv">1</span>)</code></pre></div>
<p><img src="eda_files/figure-html/unnamed-chunk-182-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Here is PC1 vs <code>z</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="op">&gt;</span><span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">pc1=</span>p<span class="op">$</span>pc[<span class="dv">1</span>,], <span class="dt">z=</span>z) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="op">+</span><span class="st">   </span><span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x=</span>pc1,<span class="dt">y=</span>z)) <span class="op">+</span><span class="st"> </span>
<span class="op">+</span><span class="st">   </span><span class="kw">theme</span>(<span class="dt">aspect.ratio=</span><span class="dv">1</span>)</code></pre></div>
<p><img src="eda_files/figure-html/unnamed-chunk-183-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="pc-biplots" class="section level2">
<h2><span class="header-section-number">18.8</span> PC Biplots</h2>
<p>Sometimes it is informative to plot a PC versus another PC. This is called a <strong>PC biplot</strong>.</p>
<p>It is possible that interesting subgroups or clusters of <em>observations</em> will emerge.</p>
</div>
<div id="pca-examples" class="section level2">
<h2><span class="header-section-number">18.9</span> PCA Examples</h2>
<div id="weather-data" class="section level3">
<h3><span class="header-section-number">18.9.1</span> Weather Data</h3>
<p>These daily temperature data (in tenths of degrees C) come from meteorogical observations for weather stations in the US for the year 2012 provided by NOAA (National Oceanic and Atmospheric Administration).:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="op">&gt;</span><span class="st"> </span><span class="kw">load</span>(<span class="st">&quot;./data/weather_data.RData&quot;</span>)
<span class="op">&gt;</span><span class="st"> </span><span class="kw">dim</span>(weather_data)
[<span class="dv">1</span>] <span class="dv">2811</span>   <span class="dv">50</span>
<span class="op">&gt;</span><span class="st"> </span>
<span class="er">&gt;</span><span class="st"> </span>weather_data[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">7</span>]
                  <span class="dv">11</span>       <span class="dv">16</span>  <span class="dv">18</span>       <span class="dv">19</span>  <span class="dv">27</span>  <span class="dv">30</span>       <span class="dv">31</span>
AG000060611 <span class="fl">138.0000</span> <span class="fl">175.0000</span> <span class="dv">173</span> <span class="fl">164.0000</span> <span class="dv">218</span> <span class="dv">160</span> <span class="fl">163.0000</span>
AGM00060369 <span class="fl">158.0000</span> <span class="fl">162.0000</span> <span class="dv">154</span> <span class="fl">159.0000</span> <span class="dv">165</span> <span class="dv">125</span> <span class="fl">171.0000</span>
AGM00060425 <span class="fl">272.7619</span> <span class="fl">272.7619</span> <span class="dv">152</span> <span class="fl">163.0000</span> <span class="dv">163</span> <span class="dv">108</span> <span class="fl">158.0000</span>
AGM00060444 <span class="fl">128.0000</span> <span class="fl">102.0000</span> <span class="dv">100</span> <span class="fl">111.0000</span> <span class="dv">125</span>  <span class="dv">33</span> <span class="fl">125.0000</span>
AGM00060468 <span class="fl">105.0000</span> <span class="fl">122.0000</span>  <span class="dv">97</span> <span class="fl">263.5714</span> <span class="dv">155</span>  <span class="dv">52</span> <span class="fl">263.5714</span></code></pre></div>
<p>This matrix contains temperature data on 50 days and 2811 stations that were randomly selected.</p>
<p>First, we will convert temperatures to Fahrenheit:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="op">&gt;</span><span class="st"> </span>weather_data &lt;-<span class="st"> </span><span class="fl">0.18</span><span class="op">*</span>weather_data <span class="op">+</span><span class="st"> </span><span class="dv">32</span>
<span class="op">&gt;</span><span class="st"> </span>weather_data[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">6</span>]
                  <span class="dv">11</span>       <span class="dv">16</span>    <span class="dv">18</span>       <span class="dv">19</span>    <span class="dv">27</span>    <span class="dv">30</span>
AG000060611 <span class="fl">56.84000</span> <span class="fl">63.50000</span> <span class="fl">63.14</span> <span class="fl">61.52000</span> <span class="fl">71.24</span> <span class="fl">60.80</span>
AGM00060369 <span class="fl">60.44000</span> <span class="fl">61.16000</span> <span class="fl">59.72</span> <span class="fl">60.62000</span> <span class="fl">61.70</span> <span class="fl">54.50</span>
AGM00060425 <span class="fl">81.09714</span> <span class="fl">81.09714</span> <span class="fl">59.36</span> <span class="fl">61.34000</span> <span class="fl">61.34</span> <span class="fl">51.44</span>
AGM00060444 <span class="fl">55.04000</span> <span class="fl">50.36000</span> <span class="fl">50.00</span> <span class="fl">51.98000</span> <span class="fl">54.50</span> <span class="fl">37.94</span>
AGM00060468 <span class="fl">50.90000</span> <span class="fl">53.96000</span> <span class="fl">49.46</span> <span class="fl">79.44286</span> <span class="fl">59.90</span> <span class="fl">41.36</span>
<span class="op">&gt;</span><span class="st"> </span>
<span class="er">&gt;</span><span class="st"> </span><span class="kw">apply</span>(weather_data, <span class="dv">1</span>, median) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="op">+</span><span class="st">   </span><span class="kw">quantile</span>(<span class="dt">probs=</span><span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.1</span>))
        <span class="dv">0</span><span class="op">%        10%</span><span class="st">        </span><span class="dv">20</span><span class="op">%        30%</span><span class="st">        </span><span class="dv">40</span><span class="op">%        50%</span><span class="st"> </span>
<span class="st">  </span><span class="fl">8.886744</span>  <span class="fl">49.010000</span>  <span class="fl">54.500000</span>  <span class="fl">58.460000</span>  <span class="fl">62.150000</span>  <span class="fl">65.930000</span> 
       <span class="dv">60</span><span class="op">%        70%</span><span class="st">        </span><span class="dv">80</span><span class="op">%        90%</span><span class="st">       </span><span class="dv">100</span>% 
 <span class="fl">69.679318</span>  <span class="fl">73.490000</span>  <span class="fl">77.990000</span>  <span class="fl">82.940000</span> <span class="fl">140.000000</span> </code></pre></div>
<p>Let’s perform PCA on these data.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="op">&gt;</span><span class="st"> </span>mypca &lt;-<span class="st"> </span><span class="kw">pca</span>(weather_data, <span class="dt">space=</span><span class="st">&quot;rows&quot;</span>)
<span class="op">&gt;</span><span class="st"> </span>
<span class="er">&gt;</span><span class="st"> </span><span class="kw">names</span>(mypca)
[<span class="dv">1</span>] <span class="st">&quot;pc&quot;</span>      <span class="st">&quot;loading&quot;</span> <span class="st">&quot;pve&quot;</span>    
<span class="op">&gt;</span><span class="st"> </span><span class="kw">dim</span>(mypca<span class="op">$</span>pc)
[<span class="dv">1</span>] <span class="dv">50</span> <span class="dv">50</span>
<span class="op">&gt;</span><span class="st"> </span><span class="kw">dim</span>(mypca<span class="op">$</span>loading)
[<span class="dv">1</span>] <span class="dv">2811</span>   <span class="dv">50</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="op">&gt;</span><span class="st"> </span>mypca<span class="op">$</span>pc[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>]
            <span class="dv">11</span>        <span class="dv">16</span>         <span class="dv">18</span>
PC1 <span class="fl">19.5166741</span> <span class="fl">25.441401</span> <span class="fl">25.9023874</span>
PC2 <span class="op">-</span><span class="fl">2.6025225</span> <span class="op">-</span><span class="fl">4.310673</span>  <span class="fl">0.9707207</span>
PC3 <span class="op">-</span><span class="fl">0.6681223</span> <span class="op">-</span><span class="fl">1.240748</span> <span class="op">-</span><span class="fl">3.7276658</span>
<span class="op">&gt;</span><span class="st"> </span>mypca<span class="op">$</span>loading[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>]
                Loading1    Loading2     Loading3
AG000060611 <span class="op">-</span><span class="fl">0.015172744</span> <span class="fl">0.013033849</span> <span class="op">-</span><span class="fl">0.011273121</span>
AGM00060369 <span class="op">-</span><span class="fl">0.009439176</span> <span class="fl">0.016884418</span> <span class="op">-</span><span class="fl">0.004611284</span>
AGM00060425 <span class="op">-</span><span class="fl">0.015779138</span> <span class="fl">0.007026312</span> <span class="op">-</span><span class="fl">0.009907972</span></code></pre></div>
<p>PC1 vs Time:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="op">&gt;</span><span class="st"> </span>day_of_the_year &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">colnames</span>(weather_data))
<span class="op">&gt;</span><span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">day=</span>day_of_the_year, <span class="dt">PC1=</span>mypca<span class="op">$</span>pc[<span class="dv">1</span>,]) <span class="op">%&gt;%</span>
<span class="op">+</span><span class="st">   </span><span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x=</span>day, <span class="dt">y=</span>PC1), <span class="dt">size=</span><span class="dv">2</span>)</code></pre></div>
<p><img src="eda_files/figure-html/unnamed-chunk-188-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>PC2 vs Time:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="op">&gt;</span><span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">day=</span>day_of_the_year, <span class="dt">PC2=</span>mypca<span class="op">$</span>pc[<span class="dv">2</span>,]) <span class="op">%&gt;%</span>
<span class="op">+</span><span class="st">   </span><span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x=</span>day, <span class="dt">y=</span>PC2), <span class="dt">size=</span><span class="dv">2</span>)</code></pre></div>
<p><img src="eda_files/figure-html/unnamed-chunk-189-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>PC1 vs PC2 Biplot:</p>
<p>This does not appear to be subgroups or clusters in the weather data set biplot of PC1 vs PC2.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="op">&gt;</span><span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">PC1=</span>mypca<span class="op">$</span>pc[<span class="dv">1</span>,], <span class="dt">PC2=</span>mypca<span class="op">$</span>pc[<span class="dv">2</span>,]) <span class="op">%&gt;%</span>
<span class="op">+</span><span class="st">   </span><span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x=</span>PC1, <span class="dt">y=</span>PC2), <span class="dt">size=</span><span class="dv">2</span>)</code></pre></div>
<p><img src="eda_files/figure-html/unnamed-chunk-190-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Proportion of Variance Explained:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="op">&gt;</span><span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">Component=</span><span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(mypca<span class="op">$</span>pve), <span class="dt">PVE=</span>mypca<span class="op">$</span>pve) <span class="op">%&gt;%</span>
<span class="op">+</span><span class="st">   </span><span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x=</span>Component, <span class="dt">y=</span>PVE), <span class="dt">size=</span><span class="dv">2</span>)</code></pre></div>
<p><img src="eda_files/figure-html/unnamed-chunk-191-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>We can multiple the loadings matrix by the PCs matrix to reproduce the data:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="op">&gt;</span><span class="st"> </span><span class="co"># mean centered weather data</span>
<span class="er">&gt;</span><span class="st"> </span>weather_data_mc &lt;-<span class="st"> </span>weather_data <span class="op">-</span><span class="st"> </span><span class="kw">rowMeans</span>(weather_data)
<span class="op">&gt;</span><span class="st"> </span>
<span class="er">&gt;</span><span class="st"> </span><span class="co"># difference between the PC projections and the data</span>
<span class="er">&gt;</span><span class="st"> </span><span class="co"># the small sum is just machine imprecision</span>
<span class="er">&gt;</span><span class="st"> </span><span class="kw">sum</span>(<span class="kw">abs</span>(weather_data_mc<span class="op">/</span><span class="kw">sqrt</span>(<span class="kw">nrow</span>(weather_data_mc)<span class="op">-</span><span class="dv">1</span>) <span class="op">-</span><span class="st"> </span>
<span class="op">+</span><span class="st">           </span>mypca<span class="op">$</span>loading <span class="op">%*%</span><span class="st"> </span>mypca<span class="op">$</span>pc))
[<span class="dv">1</span>] <span class="fl">1.329755e-10</span></code></pre></div>
<p>The sum of squared weights – i.e., loadings – equals one for each component:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="op">&gt;</span><span class="st"> </span><span class="kw">sum</span>(mypca<span class="op">$</span>loading[,<span class="dv">1</span>]<span class="op">^</span><span class="dv">2</span>)
[<span class="dv">1</span>] <span class="dv">1</span>
<span class="op">&gt;</span><span class="st"> </span>
<span class="er">&gt;</span><span class="st"> </span><span class="kw">apply</span>(mypca<span class="op">$</span>loading, <span class="dv">2</span>, <span class="cf">function</span>(x) {<span class="kw">sum</span>(x<span class="op">^</span><span class="dv">2</span>)})
 Loading1  Loading2  Loading3  Loading4  Loading5  Loading6  Loading7 
        <span class="dv">1</span>         <span class="dv">1</span>         <span class="dv">1</span>         <span class="dv">1</span>         <span class="dv">1</span>         <span class="dv">1</span>         <span class="dv">1</span> 
 Loading8  Loading9 Loading10 Loading11 Loading12 Loading13 Loading14 
        <span class="dv">1</span>         <span class="dv">1</span>         <span class="dv">1</span>         <span class="dv">1</span>         <span class="dv">1</span>         <span class="dv">1</span>         <span class="dv">1</span> 
Loading15 Loading16 Loading17 Loading18 Loading19 Loading20 Loading21 
        <span class="dv">1</span>         <span class="dv">1</span>         <span class="dv">1</span>         <span class="dv">1</span>         <span class="dv">1</span>         <span class="dv">1</span>         <span class="dv">1</span> 
Loading22 Loading23 Loading24 Loading25 Loading26 Loading27 Loading28 
        <span class="dv">1</span>         <span class="dv">1</span>         <span class="dv">1</span>         <span class="dv">1</span>         <span class="dv">1</span>         <span class="dv">1</span>         <span class="dv">1</span> 
Loading29 Loading30 Loading31 Loading32 Loading33 Loading34 Loading35 
        <span class="dv">1</span>         <span class="dv">1</span>         <span class="dv">1</span>         <span class="dv">1</span>         <span class="dv">1</span>         <span class="dv">1</span>         <span class="dv">1</span> 
Loading36 Loading37 Loading38 Loading39 Loading40 Loading41 Loading42 
        <span class="dv">1</span>         <span class="dv">1</span>         <span class="dv">1</span>         <span class="dv">1</span>         <span class="dv">1</span>         <span class="dv">1</span>         <span class="dv">1</span> 
Loading43 Loading44 Loading45 Loading46 Loading47 Loading48 Loading49 
        <span class="dv">1</span>         <span class="dv">1</span>         <span class="dv">1</span>         <span class="dv">1</span>         <span class="dv">1</span>         <span class="dv">1</span>         <span class="dv">1</span> 
Loading50 
        <span class="dv">1</span> </code></pre></div>
<p>PCs by contruction have sample correlation equal to zero:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="op">&gt;</span><span class="st"> </span><span class="kw">cor</span>(mypca<span class="op">$</span>pc[<span class="dv">1</span>,], mypca<span class="op">$</span>pc[<span class="dv">2</span>,])
[<span class="dv">1</span>] <span class="fl">3.135149e-17</span>
<span class="op">&gt;</span><span class="st"> </span><span class="kw">cor</span>(mypca<span class="op">$</span>pc[<span class="dv">1</span>,], mypca<span class="op">$</span>pc[<span class="dv">3</span>,])
[<span class="dv">1</span>] <span class="fl">2.273613e-16</span>
<span class="op">&gt;</span><span class="st"> </span><span class="kw">cor</span>(mypca<span class="op">$</span>pc[<span class="dv">1</span>,], mypca<span class="op">$</span>pc[<span class="dv">12</span>,])
[<span class="dv">1</span>] <span class="op">-</span><span class="fl">1.231339e-16</span>
<span class="op">&gt;</span><span class="st"> </span><span class="kw">cor</span>(mypca<span class="op">$</span>pc[<span class="dv">5</span>,], mypca<span class="op">$</span>pc[<span class="dv">27</span>,])
[<span class="dv">1</span>] <span class="op">-</span><span class="fl">2.099516e-17</span>
<span class="op">&gt;</span><span class="st"> </span><span class="co"># etc...</span></code></pre></div>
<p>I can transform the top PC back to the original units to display it at a scale that has a more direct interpretation.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="op">&gt;</span><span class="st"> </span>day_of_the_year &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">colnames</span>(weather_data))
<span class="op">&gt;</span><span class="st"> </span>y &lt;-<span class="st"> </span><span class="op">-</span>mypca<span class="op">$</span>pc[<span class="dv">1</span>,] <span class="op">+</span><span class="st"> </span><span class="kw">mean</span>(weather_data)
<span class="op">&gt;</span><span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">day=</span>day_of_the_year, <span class="dt">max_temp=</span>y) <span class="op">%&gt;%</span>
<span class="op">+</span><span class="st">   </span><span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x=</span>day, <span class="dt">y=</span>max_temp))</code></pre></div>
<p><img src="eda_files/figure-html/unnamed-chunk-195-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="yeast-gene-expression" class="section level3">
<h3><span class="header-section-number">18.9.2</span> Yeast Gene Expression</h3>
<p>Yeast cells were synchronized so that they were on the same approximate cell cycle timing in <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC25624/">Spellman et al. (1998)</a>. The goal was to understand how gene expression varies over the cell cycle from a genome-wide perspective.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="op">&gt;</span><span class="st"> </span><span class="kw">load</span>(<span class="st">&quot;./data/spellman.RData&quot;</span>)
<span class="op">&gt;</span><span class="st"> </span>time
 [<span class="dv">1</span>]   <span class="dv">0</span>  <span class="dv">30</span>  <span class="dv">60</span>  <span class="dv">90</span> <span class="dv">120</span> <span class="dv">150</span> <span class="dv">180</span> <span class="dv">210</span> <span class="dv">240</span> <span class="dv">270</span> <span class="dv">330</span> <span class="dv">360</span> <span class="dv">390</span>
<span class="op">&gt;</span><span class="st"> </span><span class="kw">dim</span>(gene_expression)
[<span class="dv">1</span>] <span class="dv">5981</span>   <span class="dv">13</span>
<span class="op">&gt;</span><span class="st"> </span>gene_expression[<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>]
                  <span class="dv">0</span>         <span class="dv">30</span>         <span class="dv">60</span>        <span class="dv">90</span>        <span class="dv">120</span>
YAL001C  <span class="fl">0.69542786</span> <span class="op">-</span><span class="fl">0.4143538</span>  <span class="fl">3.2350520</span> <span class="fl">1.6323737</span> <span class="op">-</span><span class="fl">2.1091820</span>
YAL002W <span class="op">-</span><span class="fl">0.01210662</span>  <span class="fl">3.0465649</span>  <span class="fl">1.1062193</span> <span class="fl">4.0591467</span> <span class="op">-</span><span class="fl">0.1166399</span>
YAL003W <span class="op">-</span><span class="fl">2.78570526</span> <span class="op">-</span><span class="fl">1.0156981</span> <span class="op">-</span><span class="fl">2.1387564</span> <span class="fl">1.9299681</span>  <span class="fl">0.7797033</span>
YAL004W  <span class="fl">0.55165887</span>  <span class="fl">0.6590093</span>  <span class="fl">0.5857847</span> <span class="fl">0.3890409</span> <span class="op">-</span><span class="fl">1.0009777</span>
YAL005C <span class="op">-</span><span class="fl">0.53191556</span>  <span class="fl">0.1577985</span> <span class="op">-</span><span class="fl">1.2401448</span> <span class="fl">0.8170350</span> <span class="op">-</span><span class="fl">1.3520947</span>
YAL007C <span class="op">-</span><span class="fl">0.86693416</span> <span class="op">-</span><span class="fl">1.1642322</span> <span class="op">-</span><span class="fl">0.6359588</span> <span class="fl">1.1179131</span>  <span class="fl">1.9587021</span></code></pre></div>
<p>Proportion Variance Explained:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="op">&gt;</span><span class="st"> </span>p &lt;-<span class="st"> </span><span class="kw">pca</span>(gene_expression, <span class="dt">space=</span><span class="st">&quot;rows&quot;</span>)
<span class="op">&gt;</span><span class="st"> </span><span class="kw">ggplot</span>(<span class="kw">data.frame</span>(<span class="dt">pc=</span><span class="dv">1</span><span class="op">:</span><span class="dv">13</span>, <span class="dt">pve=</span>p<span class="op">$</span>pve)) <span class="op">+</span><span class="st"> </span>
<span class="op">+</span><span class="st">   </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x=</span>pc,<span class="dt">y=</span>pve), <span class="dt">size=</span><span class="dv">2</span>)</code></pre></div>
<p><img src="eda_files/figure-html/unnamed-chunk-197-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>PCs vs Time (with Smoothers):</p>
<p><img src="eda_files/figure-html/unnamed-chunk-198-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="hapmap-genotypes" class="section level3">
<h3><span class="header-section-number">18.9.3</span> HapMap Genotypes</h3>
<p>I curated a small data set that cleanly separates human subpopulations from the <a href="https://en.wikipedia.org/wiki/International_HapMap_Project">HapMap</a> data. These include unrelated individuals from Yoruba people from Ibadan, Nigeria (YRI), Utah residents of northern and western European ancestry (CEU), Japanese individuals from Tokyo, Japan (JPT), and Han Chinese individuals from Beijing, China (CHB).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="op">&gt;</span><span class="st"> </span>hapmap &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="st">&quot;./data/hapmap_sample.txt&quot;</span>)
<span class="op">&gt;</span><span class="st"> </span><span class="kw">dim</span>(hapmap)
[<span class="dv">1</span>] <span class="dv">400</span>  <span class="dv">24</span>
<span class="op">&gt;</span><span class="st"> </span>hapmap[<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>]
           NA18516 NA19138 NA19137 NA19223 NA19200 NA19131
rs2051075        <span class="dv">0</span>       <span class="dv">1</span>       <span class="dv">2</span>       <span class="dv">1</span>       <span class="dv">1</span>       <span class="dv">1</span>
rs765546         <span class="dv">2</span>       <span class="dv">2</span>       <span class="dv">0</span>       <span class="dv">0</span>       <span class="dv">0</span>       <span class="dv">0</span>
rs10019399       <span class="dv">2</span>       <span class="dv">2</span>       <span class="dv">2</span>       <span class="dv">1</span>       <span class="dv">1</span>       <span class="dv">2</span>
rs7055827        <span class="dv">2</span>       <span class="dv">2</span>       <span class="dv">1</span>       <span class="dv">2</span>       <span class="dv">0</span>       <span class="dv">2</span>
rs6943479        <span class="dv">0</span>       <span class="dv">0</span>       <span class="dv">2</span>       <span class="dv">0</span>       <span class="dv">1</span>       <span class="dv">0</span>
rs2095381        <span class="dv">1</span>       <span class="dv">2</span>       <span class="dv">1</span>       <span class="dv">2</span>       <span class="dv">1</span>       <span class="dv">1</span></code></pre></div>
<p>Proportion Variance Explained:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="op">&gt;</span><span class="st"> </span>p &lt;-<span class="st"> </span><span class="kw">pca</span>(hapmap, <span class="dt">space=</span><span class="st">&quot;rows&quot;</span>)
<span class="op">&gt;</span><span class="st"> </span><span class="kw">ggplot</span>(<span class="kw">data.frame</span>(<span class="dt">pc=</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(hapmap)), <span class="dt">pve=</span>p<span class="op">$</span>pve)) <span class="op">+</span><span class="st"> </span>
<span class="op">+</span><span class="st">   </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x=</span>pc,<span class="dt">y=</span>pve), <span class="dt">size=</span><span class="dv">2</span>)</code></pre></div>
<p><img src="eda_files/figure-html/unnamed-chunk-200-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>PC1 vs PC2 Biplot:</p>
<p><img src="eda_files/figure-html/unnamed-chunk-201-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>PC1 vs PC3 Biplot:</p>
<p><img src="eda_files/figure-html/unnamed-chunk-202-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>PC2 vs PC3 Biplot:</p>
<p><img src="eda_files/figure-html/unnamed-chunk-203-1.png" width="672" style="display: block; margin: auto;" /></p>

</div>
</div>
</div>



            </section>

          </div>
        </div>
      </div>
<a href="cluster-analysis.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="references.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/jdstorey/yarp/edit/master/eda.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
